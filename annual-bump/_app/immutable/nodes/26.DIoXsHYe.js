import{a as ta,p as ra,X as oa,J as q,a3 as ia,C as D,z as E,B as na,f as la,g as c,K as pa,k as d,h as da,m as _,q as m,r as ma,t as ca,G as N,u as b,N as T,n as ua,L as t,A as va,F as l,y as u,ad as j,ae as ga,af as fa,a5 as z,a8 as I,R as r,_ as L,a0 as P,ag as _a,ab as ba,ah as ha,M as $a,ai as xa,x as B}from"../chunks/C6V5fW-3.js";import{U as ya}from"../chunks/Bj1PSOzY.js";import{o as wa,s as Ma,a as Sa,b as Ua,c as Va,v as ka,r as Aa,V as G}from"../chunks/D4Q3ivdy.js";import{t as Ca}from"../chunks/D9jQKVoZ.js";import{u as J}from"../chunks/BRQD3YPY.js";import{M as Fa}from"../chunks/B7wvMWpi.js";import{t as K}from"../chunks/BLzR2Xnx.js";e[l]="src/routes/settings/+page.svelte";var qa=c(u("<p>Please log in</p>"),e[l],[[74,6]]),Da=c(u('<span class="validation-message"> </span>'),e[l],[[89,16]]),Ea=c(u('<span class="validation-message"> </span>'),e[l],[[101,16]]),Na=c(u('<form><div class="grid grid-flow-row gap-6"><div class="grid grid-flow-row gap-2"><label for="avatar">Avatar:</label> <input id="avatar" class="base-input" name="avatar" type="file" accept="image/png,image/jpeg,image/gif" placeholder="Avatar"/> <!></div> <div class="grid grid-flow-row gap-2"><label class="label"><span>Username</span> <input type="text" required class="input p-2"/></label> <!></div> <div><button class="btn border border-primary-500 preset-tonal-primary" type="submit">Save</button></div></div></form>'),e[l],[[76,6,[[77,8,[[78,10,[[79,12],[80,12]]],[94,10,[[95,12,[[96,14],[97,14]]]]],[106,10,[[107,12]]]]]]]]),Ta=c(u('<h1 class="my-4 text-4xl font-bold">Settings</h1> <div class="card preset-filled-surface-100-900 p-4"><section><!></section></div>',1),e[l],[[69,0],[71,0,[[72,2]]]]);function e(R,X){ta(new.target),ra(X,!0,e);const v=()=>(N(J,"user"),D(J,"$user",h)),g=()=>(N(b(f),"data"),D(b(f),"$data",h)),[h,H]=ca(),O=oa(),S=wa({avatar:Sa(Ua().refine(a=>"name"in a&&"size"in a&&"type"in a)),username:Ma().min(3).max(32)});let U=q(T(void 0),"form"),f=q(T(void 0),"data");ia(()=>{if(v()&&!g()){const a=Va({initialValues:{username:v().username},extend:[ka({schema:S}),Aa],onSubmit:s=>{console.log(...j("log","submitted",s)),O.mutation(ya,{user:Ca(s,S),userId:v().id}).toPromise().then(o=>{o.error?(console.error(...j("error",o.error.message)),K.error({description:"Error editing user: "+o.error.message})):(K.success({description:"User updated",duration:5e3}),ga(fa+"/user/"+o.data.updateUser.id))})}});E(U,a.form,!0),na(E(f,a.data,!0),"$data",h)}});var Q={...la()},V=Ta();pa(a=>{_(()=>Fa(a,{description:"Change your user settings",title:"Settings"}),"component",e,66,2,{componentTag:"MetaDescriptors"})});var k=d(da(V),2),A=t(k),W=t(A);{var Y=a=>{var s=qa();m(a,s)},Z=a=>{var s=Na(),o=t(s),$=t(o),ea=d(t($),4);{const i=z(e,function(y,w){I(...arguments);let p=()=>w?.().messages;p();var n=Da(),M=t(n,!0);r(n),L(()=>P(M,p()||"")),m(y,n)});_(()=>G(ea,{for:"avatar",children:i,$$slots:{default:!0}}),"component",e,87,12,{componentTag:"ValidationMessage"})}r($);var C=d($,2),x=t(C),F=d(t(x),2);_a(F),r(x);var sa=d(x,2);{const i=z(e,function(y,w){I(...arguments);let p=()=>w?.().messages;p();var n=Ea(),M=t(n,!0);r(n),L(()=>P(M,p()||"")),m(y,n)});_(()=>G(sa,{for:"username",children:i,$$slots:{default:!0}}),"component",e,99,12,{componentTag:"ValidationMessage"})}r(C),ba(2),r(o),r(s),ha(s,i=>b(U)?.(i)),$a(F,()=>g().username,i=>xa(b(f),B(g).username=i,B(g))),m(a,s)};_(()=>ua(W,a=>{va(v(),null)?a(Y):a(Z,!1)}),"if",e,73,4)}r(A),r(k),m(R,V);var aa=ma(Q);return H(),aa}export{e as component};
//# sourceMappingURL=26.DIoXsHYe.js.map
