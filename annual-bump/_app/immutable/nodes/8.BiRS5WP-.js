import{I as me,a as _e,p as ue,X as ge,J as k,f as fe,g as m,K as be,k as n,h as O,m as d,q as p,r as he,t as ye,N as S,O as z,n as U,u as e,L as o,C as Ve,F as v,y as _,G as Pe,as as xe,z as $,R as r,D as De,_ as J,a0 as w,a9 as ke,T as Ue,ap as K,af as $e}from"../chunks/aDZdp7_x.js";import{n as we,o as qe,p as Ae}from"../chunks/Bj1PSOzY.js";import{a as Me}from"../chunks/CDGGhnbA.js";import"../chunks/Bc2UF0Gl.js";import{M as Te}from"../chunks/C0Ue59i3.js";import{a as Ce}from"../chunks/CwkDO0EH.js";import{P as X}from"../chunks/B6-LF4Tz.js";a[v]="src/routes/admin/unapproved-versions/+page.svelte";var Ee=m(_('<div class="mb-5 ml-auto flex justify-end"><div><!></div></div>'),a[v],[[58,2,[[59,4]]]]),Ie=m(_('<section class="p-4">Loading...</section>'),a[v],[[67,4]]),Le=m(_('<section class="p-4"> </section>'),a[v],[[69,4]]),Re=m(_('<tr><td> </td><td> </td><td> </td><td class="!p-2.5"><div class="grid grid-flow-col gap-4"><button class="btn border border-primary-500 preset-tonal-primary">Approve</button> <button class="btn border border-primary-500 preset-tonal-primary">Deny</button> <a class="btn border border-primary-500 preset-tonal-primary">Download</a> <a class="btn border border-primary-500 preset-tonal-primary">View</a></div></td></tr>'),a[v],[[82,10,[[83,12],[84,12],[85,12],[86,12,[[87,14,[[88,16],[91,16],[94,16],[99,16]]]]]]]]),je=m(_('<table class="table max-w-full"><thead><tr><th>Mod</th><th>Version</th><th>Release Date</th><th></th></tr></thead><tbody></tbody></table>'),a[v],[[71,4,[[72,6,[[73,8,[[74,10],[75,10],[76,10],[77,10]]]]],[80,6]]]]),Fe=m(_('<div class="mt-5 ml-auto flex justify-end"><!></div>'),a[v],[[114,2]]),Ge=m(_('<h1 class="svelte-qyqh9t">Unapproved Versions</h1> <!> <div class="card preset-filled-surface-100-900"><!></div> <!>',1),a[v],[[55,0],[65,0]]);function a(B,H){_e(new.target),ue(H,!0,a);const u=()=>(Pe(e(f),"versions"),Ve(e(f),"$versions",Q)),[Q,W]=ye(),q=ge();let g=k(S(20),"perPage"),y=k(S(1),"page"),f=k(z(()=>xe({query:we,client:q,variables:{filter:{offset:(e(y)-1)*e(g),limit:e(g)}}})),"versions"),x=k(z(()=>u()?.data?.getUnapprovedVersions?.count),"totalVersions");const Y=t=>{q.mutation(qe,{versionId:t}).toPromise().then(()=>{e(f).pause(),e(f).resume()})},Z=t=>{q.mutation(Ae,{versionId:t}).toPromise().then(()=>{e(f).pause(),e(f).resume()})};var ee={...fe()},I=Ge();be(t=>{d(()=>Te(t,{description:"Unapproved mod versions",title:"Admin: Unapproved Versions"}),"component",a,52,2,{componentTag:"MetaDescriptors"})});var L=n(O(I),2);{var te=t=>{var s=Ee(),b=o(s),l=o(b);d(()=>X(l,{get total(){return e(x)},get page(){return e(y)},set page(V){$(y,V,!0)},get perPage(){return e(g)},set perPage(V){$(g,V,!0)}}),"component",a,60,6,{componentTag:"Pager"}),r(b),r(s),p(t,s)};d(()=>U(L,t=>{e(x)&&t(te)}),"if",a,57,0)}var A=n(L,2),ae=o(A);{var re=t=>{var s=Ie();p(t,s)},se=t=>{var s=De(),b=O(s);{var l=h=>{var c=Le(),D=o(c);r(c),J(()=>w(D,`Oh no... ${u().error.message??""}`)),p(h,c)},V=h=>{var c=je(),D=n(o(c));ke(()=>u().data.getUnapprovedVersions.versions,P=>P.id),d(()=>Ue(D,5,()=>u().data.getUnapprovedVersions.versions,P=>P.id,(P,i)=>{var M=Re(),T=o(M),de=o(T,!0);r(T);var C=n(T),pe=o(C,!0);r(C);var E=n(C),ve=o(E,!0);r(E);var R=n(E),j=o(R),F=o(j);F.__click=()=>Y(e(i).id);var G=n(F,2);G.__click=()=>Z(e(i).id);var N=n(G,2),le=n(N,2);r(j),r(R),r(M),J(ce=>{w(de,e(i).mod.name),w(pe,e(i).version),w(ve,ce),K(N,"href",Me+"/mod/"+e(i).mod_id+"/versions/"+e(i).id+"/download"),K(le,"href",$e+"/mod/"+e(i).mod_id+"/version/"+e(i).id)},[()=>Ce(e(i).created_at)]),p(P,M)}),"each",a,81,8),r(D),r(c),p(h,c)};d(()=>U(b,h=>{u().error?h(l):h(V,!1)},!0),"if",a,68,2)}p(t,s)};d(()=>U(ae,t=>{u().fetching?t(re):t(se,!1)}),"if",a,66,2)}r(A);var oe=n(A,2);{var ne=t=>{var s=Fe(),b=o(s);d(()=>X(b,{get total(){return e(x)},get page(){return e(y)},set page(l){$(y,l,!0)},get perPage(){return e(g)},set perPage(l){$(g,l,!0)}}),"component",a,115,4,{componentTag:"Pager"}),r(s),p(t,s)};d(()=>U(oe,t=>{e(x)&&t(ne)}),"if",a,113,0)}p(B,I);var ie=he(ee);return W(),ie}me(["click"]);export{a as component};
//# sourceMappingURL=8.BiRS5WP-.js.map
