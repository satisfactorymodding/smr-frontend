import{I as De,a as Fe,p as Ie,Y as we,av as Pe,au as Te,aw as qe,J as Ee,f as Le,g as f,k as _,h as d,m as l,q as o,r as Qe,t as Ge,O as Oe,n as R,L as A,C as ze,F as v,y as m,G as Me,D as L,S as C,a0 as V,a1 as W,ay as D,a4 as F,a9 as Ue,u as t,U as je,a6 as Q,ab as Je,ac as Ne,an as X,_ as G,j as Ye,M as Z,A as ee,ad as te,a3 as O,az as Be,z as ae}from"../chunks/DXyKL7ev.js";import{c as He,d as Ke,e as Re,f as Ve}from"../chunks/C2xQDKU4.js";import{t as b}from"../chunks/CvZBqrLn.js";s[v]="src/routes/admin/satisfactory-versions/+page.svelte";var We=f(m('<h1 class="svelte-1xd3fmf">Loading satisfactory versions...</h1>'),s[v],[[151,4]]),Xe=f(m('<h1 class="svelte-1xd3fmf"> </h1>'),s[v],[[153,4]]),Ze=f(m('<div><div>Game CL#</div> <input type="text" class="input p-2" placeholder="Version"/> <div>Engine Version</div> <input type="text" class="input p-2" placeholder="Engine version"/></div> <button class="btn border border-error-500 preset-tonal-error"><span>Delete</span></button>',1),s[v],[[162,12,[[163,14],[164,14],[171,14],[172,14]]],[180,12,[[183,14]]]]),et=f(m("<!> <!>",1),s[v],[]),tt=f(m('<!> <section class="p-4"><button class="btn border border-primary-500 preset-tonal-primary"><span>Add new Satisfactory version</span> <span class="material-icons">add</span></button></section>',1),s[v],[[190,4,[[191,6,[[192,8],[193,8]]]]]]),at=f(m('<h1 class="svelte-1xd3fmf">Satisfactory Versions</h1> <div class="card preset-filled-surface-100-900"><!></div>',1),s[v],[[147,0],[149,0]]);function s(se,re){Fe(new.target),Ie(re,!0,s);const S=()=>(Me(M,"satisfactoryVersionsQuery"),ze(M,"$satisfactoryVersionsQuery",ne)),[ne,oe]=Ge(),x=we(),z={},g=Pe(Te({}),"versionFields"),M=qe({query:He,client:x});let n=Ee(Oe(()=>S().data?.getSatisfactoryVersions||[]),"satisfactoryVersions");function ie(){if(t(n).find(e=>e.id<0))z[t(n)[t(n).length-1].id].setOpen(!0),g[t(n)[t(n).length-1].id].focus();else{const e={id:-1,version:0,engine_version:"4.26"};t(n).push(e),ae(n,t(n)),setTimeout(()=>{z[e.id].setOpen(!0);const a=g[e.id];a.focus(),a.getElement().querySelectorAll("input")[0].select()},0)}}async function U(e){if(ee(e.version,0))return;console.log(...te("log",e));let a=!1;if(e.id<0){try{const c=(await O(x.mutation(Ke,{satisfactoryVersion:{version:e.version,engine_version:e.engine_version}}).toPromise()))();c.data&&(e.id=c.data.createSatisfactoryVersion.id,a=!0)}catch(c){console.log(...te("log",c))}if(!a){b.error({description:`Failed to create Satisfactory version '${e.version}'!`,duration:2e3});return}}else{try{a=Be((await O(x.mutation(Re,{id:e.id,satisfactoryVersion:{version:e.version,engine_version:e.engine_version}}).toPromise()))().data.updateSatisfactoryVersion,null,!1)}catch{}if(!a){b.error({description:`Failed to update Satisfactory version '${e.version}'!`,duration:2e3});return}}b.success({description:`Satisfactory version '${e.version}' saved!`,duration:2e3})}async function ce(e){if(!(e.id<0)){let a=!1;try{a=(await O(x.mutation(Ve,{satisfactoryVersionID:e.id}).toPromise()))().data.deleteSatisfactoryVersion,a&&ae(n,t(n).filter(I=>ee(I.id,e.id,!1)))}catch{a=!1}if(!a){b.error({description:`Failed to remove Satisfactory version '${e.version}'!`,duration:2e3});return}}b.success({description:`Satisfactory version '${e.version}' removed!`,duration:2e3})}function de(e,a){e.stopPropagation(),ce(a)}var le={...Le()},j=at(),J=_(d(j),2),ve=A(J);{var ue=e=>{var a=We();o(e,a)},pe=e=>{var a=L(),c=d(a);{var I=u=>{var p=Xe(),k=A(p);C(p),V(()=>W(k,`Failed to load satisfactory versions: ${S().error.message??""}`)),o(u,p)},fe=u=>{var p=tt(),k=d(p);l(()=>D(k,{children:F(s,(ge,st)=>{var Y=L(),he=d(Y);Ue(()=>t(n),h=>h.id),l(()=>je(he,17,()=>t(n),h=>h.id,(h,r,rt)=>{var B=L(),ye=d(B);l(()=>Q(ye,()=>D.Item,($e,be)=>{be($e,{get value(){return t(r).id},children:F(s,(Se,nt)=>{var H=et(),K=d(H);l(()=>Q(K,()=>D.ItemTrigger,(w,P)=>{P(w,{children:F(s,(T,ke)=>{Je();var y=Ne();V(()=>W(y,t(r).version)),o(T,y)}),$$slots:{default:!0}})}),"component",s,158,10,{componentTag:"Accordion.ItemTrigger"});var xe=_(K,2);l(()=>Q(xe,()=>D.ItemContent,(w,P)=>{P(w,{children:F(s,(T,ke)=>{var y=Ze(),q=d(y),$=_(A(q),2);X($),$.__change=()=>U(t(r)),G("bind:value={satisfactoryVersion.version}",[],()=>t(r),()=>"version",167,16),G("bind:this={versionFields[satisfactoryVersion.id]}",[],()=>g,()=>t(r).id,169,16),Ye($,(i,Ce)=>g[Ce.id]=i,i=>g?.[i.id],()=>[t(r)]);var E=_($,4);X(E),E.__change=()=>U(t(r)),G("bind:value={satisfactoryVersion.engine_version}",[],()=>t(r),()=>"engine_version",175,16),C(q);var Ae=_(q,2);Ae.__click=i=>de(i,t(r)),Z($,()=>t(r).version,i=>t(r).version=i),Z(E,()=>t(r).engine_version,i=>t(r).engine_version=i),o(T,y)}),$$slots:{default:!0}})}),"component",s,161,10,{componentTag:"Accordion.ItemContent"}),o(Se,H)}),$$slots:{default:!0}})}),"component",s,157,8,{componentTag:"Accordion.Item"}),o(h,B)}),"each",s,156,6),o(ge,Y)}),$$slots:{default:!0}}),"component",s,155,4,{componentTag:"Accordion"});var N=_(k,2),me=A(N);me.__click=ie,C(N),o(u,p)};l(()=>R(c,u=>{S().error?u(I):u(fe,!1)},!0),"if",s,152,2)}o(e,a)};l(()=>R(ve,e=>{S().fetching?e(ue):e(pe,!1)}),"if",s,150,2)}C(J),o(se,j);var _e=Qe(le);return oe(),_e}De(["change","click"]);export{s as component};
//# sourceMappingURL=5.CsUlMBDP.js.map
