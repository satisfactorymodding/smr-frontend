{"version":3,"file":"12.DsKDMa-A.js","sources":["../../../../../../src/routes/guide/[guideId]/+page.ts","../../../../../../src/lib/components/guides/GuideInfo.svelte","../../../../../../src/lib/components/guides/GuideAuthor.svelte","../../../../../../src/routes/guide/[guideId]/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\nimport { queryStore } from '@urql/svelte';\nimport { GetGuideDocument } from '$lib/generated';\nimport { loadWaitForNoFetch } from '$lib/utils/gql';\n\nexport const prerender = false;\n\nexport const load: PageLoad = async ({ params, parent }) => ({\n  ...params,\n  ...(await loadWaitForNoFetch({\n    guide: queryStore({\n      query: GetGuideDocument,\n      client: (await parent()).client,\n      variables: { guide: params.guideId }\n    })\n  }))\n});\n","<script lang=\"ts\">\n  import type { Guide } from '$lib/generated';\n  import { prettyDate } from '$lib/utils/formatting';\n  import { getTranslate } from '@tolgee/svelte';\n\n  interface Props {\n    guide: Pick<Guide, 'created_at'>;\n  }\n\n  let { guide }: Props = $props();\n\n  export const { t } = getTranslate();\n</script>\n\n<div class=\"card preset-filled-surface-100-900 p-4\">\n  <section>\n    <div class=\"text-lg\">\n      <h3 class=\"my-4 text-2xl font-bold\">{$t('entry.info')}</h3>\n      <span><strong>{$t('entry.created-at')}:</strong> {prettyDate(guide.created_at)}</span><br />\n    </div>\n  </section>\n</div>\n","<script lang=\"ts\">\n  import type { User } from '$lib/generated';\n  import { base } from '$app/paths';\n  import { getTranslate } from '@tolgee/svelte';\n\n  interface Props {\n    author: Pick<User, 'id' | 'username' | 'avatar'>;\n  }\n\n  let { author }: Props = $props();\n\n  export const { t } = getTranslate();\n</script>\n\n<div class=\"card preset-filled-surface-100-900 p-4\">\n  <section>\n    <div class=\"grid grid-flow-row gap-y-2\">\n      <h3 class=\"my-4 text-2xl font-bold\">{$t('author')}</h3>\n\n      <div class=\"grid auto-rows-min gap-y-4 text-lg\">\n        <div class=\"grid auto-cols-min grid-flow-col gap-x-4\">\n          <div class=\"h-14 w-14 rounded-full bg-cover\" style={`background-image: url(\"${author.avatar}\")`}></div>\n          <div class=\"grid grid-flow-row\">\n            <a href=\"{base}/user/{author.id}/\" class=\"text-yellow-500 underline\">{author.username}</a>\n            <div>{$t('role.writer')}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </section>\n</div>\n","<script lang=\"ts\">\n  import { DeleteGuideDocument } from '$lib/generated';\n  import GuideInfo from '$lib/components/guides/GuideInfo.svelte';\n  import GuideAuthor from '$lib/components/guides/GuideAuthor.svelte';\n  import { user } from '$lib/stores/user';\n  import { goto } from '$app/navigation';\n  import { markdown } from '$lib/utils/markdown';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import { getContextClient } from '@urql/svelte';\n  import type { PageData } from './$types';\n  import Page404 from '$lib/components/general/Page404.svelte';\n  import { toaster } from '$lib/utils/toaster-svelte';\n  import BasicModal from '$lib/components/general/BasicModal.svelte';\n\n  interface Props {\n    data: PageData;\n  }\n\n  let { data }: Props = $props();\n\n  let { guideId, guide } = $derived(data);\n\n  const client = getContextClient();\n\n  let canUserEdit = $derived($user?.roles?.deleteContent || $user?.id === $guide?.data?.getGuide?.user?.id);\n\n  const deleteGuideFn = () => {\n    client\n      .mutation(DeleteGuideDocument, { guideId })\n      .toPromise()\n      .then((value) => {\n        if (value.error) {\n          console.error(value.error.message);\n          toaster.error({\n            description: 'Error deleting guide: ' + value.error.message\n          });\n        } else {\n          toaster.success({\n            description: `Guide deleted`,\n            duration: 5000\n          });\n          goto(base + '/guides');\n        }\n      });\n  };\n\n  let deleteModalOpen = $state(false);\n</script>\n\n<svelte:head>\n  {#if !$guide.fetching && !$guide.error && $guide.data.getGuide}\n    <MetaDescriptors description={$guide.data.getGuide.short_description} title={$guide.data.getGuide.name} />\n  {/if}\n</svelte:head>\n\n{#if $guide.fetching}\n  <p>Loading...</p>\n{:else if $guide.error}\n  <p>Oh no... {$guide.error.message}</p>\n{:else if $guide.data.getGuide}\n  <div class=\"xlx:grid-flow-row grid gap-6\">\n    <div class=\"flex h-auto flex-wrap items-center justify-between\">\n      <h1 class=\"text-4xl font-bold\">{$guide.data.getGuide.name}</h1>\n\n      <div>\n        {#if canUserEdit}\n          <button\n            class=\"btn border border-primary-500 preset-tonal-primary\"\n            onclick={() => goto(base + '/guide/' + guideId + '/edit')}>\n            <span class=\"material-icons pr-2\">edit</span>\n            Edit</button>\n\n          <BasicModal\n            bind:open={deleteModalOpen}\n            title=\"Delete guide?\"\n            body=\"Are you sure you wish to delete this guide?\"\n            buttonTextCancel=\"Cancel\"\n            buttonTextConfirm=\"Delete\"\n            confirm={deleteGuideFn} />\n          <button class=\"btn border border-primary-500 preset-tonal-primary\" onclick={() => (deleteModalOpen = true)}>\n            <span class=\"material-icons pr-2\">delete</span>\n            Delete</button>\n        {/if}\n      </div>\n    </div>\n    <div class=\"grid-auto-max grid auto-cols-fr gap-4\">\n      <div class=\"h-fit card preset-filled-surface-100-900 p-4\">\n        <section>\n          <div class=\"markdown-content break-words\">\n            {#await markdown($guide.data.getGuide.guide) then guideRendered}\n              <!-- eslint-disable -->\n              <p>{@html guideRendered}</p>\n            {/await}\n          </div>\n        </section>\n      </div>\n      <div class=\"grid auto-rows-min grid-cols-1 gap-8\">\n        <GuideInfo guide={$guide.data.getGuide} />\n        <GuideAuthor author={$guide.data.getGuide.user} />\n      </div>\n    </div>\n  </div>\n{:else}\n  <Page404 />\n{/if}\n"],"names":["prerender","load","params","parent","loadWaitForNoFetch","queryStore","GetGuideDocument","t","getTranslate","$t","prettyDate","$.set_attribute","a","base","guideId","guide","client","getContextClient","canUserEdit","$user","$guide","deleteGuideFn","DeleteGuideDocument","$.get","value","$.log_if_contains_state","toaster","goto","deleteModalOpen","$$render","consequent","button","$$value","button_1","$.set","consequent_3","markdown","$$anchor","guideRendered","$.template_effect","$.set_text","text_1","consequent_4","alternate","consequent_2","alternate_1","consequent_1","alternate_2"],"mappings":"6tBAKO,MAAMA,GAAY,GAEZC,GAAiB,MAAO,CAAE,OAAAC,EAAQ,OAAAC,MAAc,CAC3D,GAAGD,EACH,GAAI,MAAME,GAAmB,CAC3B,MAAOC,GAAW,CAChB,MAAOC,GACP,QAAS,MAAMH,EAAA,GAAU,OACzB,UAAW,CAAE,MAAOD,EAAO,OAAA,CAAQ,CACpC,CAAA,CACF,CACH,icChBA,yEAWiB,CAAA,EAAAK,CAAC,EAAKC,GAAY,0MAMQ,IAAAC,EAAE,EAAC,YAAY,EACrC,IAAAA,EAAE,EAAC,kBAAkB,EAAc,IAAAC,WAAiB,UAAU,mCANnF,0lBCZA,yEAWiB,CAAA,EAAAH,CAAC,EAAKC,GAAY,4PAU4D,MAAM,IAAA,EAE/EG,GAAAC,EAAA,OAAA,GAAAC,wBAAmB,IAAE,EAAA,GAAA,eAA8C,QAAQ,UANtD,CAAA,IAAAJ,EAAE,EAAC,QAAQ,EAAA,IAOpCA,EAAE,EAAC,aAAa,CAAA,kCAZlC,0/BCZA,4HAqBQ,IAAAK,kBAAA,OAAO,EAAA,SAAA,EAAEC,kBAAA,KAAK,EAAA,OAAA,EAEd,MAAAC,EAASC,GAAgB,EAE3B,IAAAC,WAAuBC,EAAK,GAAE,OAAO,kBAAiBA,EAAK,GAAE,GAAOC,EAAM,GAAE,MAAM,UAAU,MAAM,EAAE,CAAA,EAAA,aAAA,EAElG,MAAAC,EAAa,IAAS,CAC1BL,EACG,SAASM,GAAmB,CAAI,QAAOC,EAAPT,CAAO,CAAA,CAAA,EACvC,UAAS,EACT,KAAMU,GAAU,CACXA,EAAM,OACR,QAAQ,MAAK,GAAAC,GAAA,QAACD,EAAM,MAAM,OAAO,CAAA,EACjCE,GAAQ,MAAK,CACX,YAAa,yBAA2BF,EAAM,MAAM,QAAA,IAGtDE,GAAQ,QAAO,CACb,YAAW,gBACX,SAAU,IAAA,EAEZC,GAAKd,GAAO,SAAS,EAEzB,CAAC,CACL,EAEI,IAAAe,OAAyB,EAAK,EAAA,iBAAA,yFAKF,OAAAR,EAAM,EAAC,KAAK,SAAS,+BAA0B,OAAAA,EAAM,EAAC,KAAK,SAAS,6EAD9FA,EAAM,EAAC,UAAQ,CAAKA,EAAM,EAAC,OAASA,EAAM,EAAC,KAAK,UAAQS,EAAAC,CAAA,kJAQjDV,EAAM,EAAC,MAAM,SAAO,EAAA,EAAA,CAAA,2IAURW,EAAA,QAAA,IAAAJ,GAAKd,GAAO,UAASU,EAAGT,CAAO,EAAG,OAAO,iKAU/CO,sBALEO,CAAe,mBAAfA,EAAeI,GAAA,EAAA,oEAMuDC,GAAA,QAAA,IAAAC,GAAAN,EAAkB,EAAI,2BAdtGV,CAAW,GAAAW,EAAAM,EAAA,8FAwBJC,GAAShB,EAAM,EAAC,KAAK,SAAS,KAAK,EAAA,KAAA,CAAAiB,EAAOC,IAAa,8BAEnDA,CAAa,CAAA,0GAMXlB,EAAM,EAAC,KAAK,mGACT,OAAAA,EAAM,EAAC,KAAK,SAAS,2EApCZmB,EAAA,IAAAC,EAAAC,GAAArB,EAAM,EAAC,KAAK,SAAS,IAAI,CAAA,6FAHrDA,EAAM,EAAC,KAAK,SAAQS,EAAAa,EAAA,EAAAb,EAAAc,GAAA,EAAA,0CAFpBvB,EAAM,EAAC,MAAKS,EAAAe,CAAA,EAAAf,EAAAgB,EAAA,EAAA,0CAFjBzB,EAAM,EAAC,SAAQS,EAAAiB,CAAA,EAAAjB,EAAAkB,EAAA,EAAA,gDARpB"}