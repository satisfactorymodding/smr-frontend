{"version":3,"file":"7.CkQuTjWg.js","sources":["../../../../../../src/routes/admin/unapproved-mods/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { ApproveModDocument, DenyModDocument, GetUnapprovedModsDocument } from '$lib/generated';\n  import { getContextClient, queryStore } from '@urql/svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import { prettyDate } from '$lib/utils/formatting';\n  import Pager from '$lib/components/general/Pager.svelte';\n\n  const client = getContextClient();\n\n  let perPage = $state(20);\n  let page = $state(0);\n\n  let mods = $derived(\n    queryStore({\n      query: GetUnapprovedModsDocument,\n      client,\n      variables: {\n        filter: {\n          offset: page * perPage,\n          limit: perPage\n        }\n      }\n    })\n  );\n\n  let totalMods = $derived($mods?.data?.getUnapprovedMods?.count);\n\n  const approveMod = (modId: string) => {\n    client\n      .mutation(ApproveModDocument, { modId })\n      .toPromise()\n      .then(() => {\n        mods.pause();\n        mods.resume();\n      });\n  };\n\n  const denyMod = (modId: string) => {\n    client\n      .mutation(DenyModDocument, { modId })\n      .toPromise()\n      .then(() => {\n        mods.pause();\n        mods.resume();\n      });\n  };\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Unapproved mods\" title=\"Admin: Unapproved Mods\" />\n</svelte:head>\n\n<h1>Unapproved Mods</h1>\n\n{#if totalMods}\n  <div class=\"mb-5 ml-auto flex justify-end\">\n    <div>\n      <Pager bind:page bind:perPage total={totalMods} />\n    </div>\n  </div>\n{/if}\n\n<div class=\"card preset-filled-surface-100-900\">\n  {#if $mods.fetching}\n    <section class=\"p-4\">Loading...</section>\n  {:else if $mods.error}\n    <section class=\"p-4\">Oh no... {$mods.error.message}</section>\n  {:else}\n    <table class=\"table max-w-full\">\n      <thead>\n        <tr>\n          <th>Mod</th>\n          <th>Description</th>\n          <th>Release Date</th>\n          <th><!-- Buttons --></th>\n        </tr>\n      </thead>\n      <tbody>\n        {#each $mods.data.getUnapprovedMods.mods as mod (mod.id)}\n          <tr>\n            <td>{mod.name}</td>\n            <td>{mod.short_description}</td>\n            <td>{prettyDate(mod.created_at)}</td>\n            <td class=\"!p-2.5\">\n              <div class=\"grid grid-flow-col gap-4\">\n                <button\n                  class=\"btn border border-primary-500 preset-tonal-primary btn-sm\"\n                  onclick={() => approveMod(mod.id)}>Approve</button>\n                <button\n                  class=\"btn border border-primary-500 preset-tonal-primary btn-sm\"\n                  onclick={() => denyMod(mod.id)}>Deny</button>\n                <a class=\"btn border border-primary-500 preset-tonal-primary btn-sm\" href={base + '/mod/' + mod.id}\n                  >View</a>\n              </div>\n            </td>\n          </tr>\n        {/each}\n      </tbody>\n    </table>\n  {/if}\n</div>\n\n{#if totalMods}\n  <div class=\"mt-5 ml-auto flex justify-end\">\n    <div>\n      <Pager bind:page bind:perPage total={totalMods} />\n    </div>\n  </div>\n{/if}\n\n<style lang=\"postcss\">\n  @reference \"../../../app.css\";\n\n  h1 {\n    @apply my-4 text-4xl font-bold;\n  }\n</style>\n"],"names":["client","getContextClient","perPage","page","mods","$.tag","queryStore","GetUnapprovedModsDocument","$.get","totalMods","$mods","approveMod","modId","ApproveModDocument","denyMod","DenyModDocument","$$render","consequent","mod","$.each","tbody","$.set_text","text_1","text_2","$.set_attribute","a","base","prettyDate","consequent_2","alternate","consequent_1","alternate_1","consequent_3"],"mappings":"sqDAAA,uFAQQA,EAASC,GAAgB,EAE3B,IAAAC,MAAiB,EAAE,EAAA,SAAA,EACnBC,MAAc,CAAC,EAAA,MAAA,EAEfC,EAAIC,QACNC,GAAU,CACR,MAAOC,GACP,OAAAP,EACA,UAAS,CACP,OAAM,CACJ,OAAMQ,EAAEL,CAAI,IAAGD,CAAO,EACtB,MAAKM,EAAEN,CAAA,CAAA,cAMXO,UAAqBC,KAAO,MAAM,mBAAmB,KAAK,EAAA,WAAA,QAExDC,EAAcC,GAAkB,CACpCZ,EACG,SAASa,GAAkB,CAAI,MAAAD,CAAK,CAAA,EACpC,UAAS,EACT,KAAI,IAAO,CACVJ,EAAAJ,CAAI,EAAC,MAAK,EACVI,EAAAJ,CAAI,EAAC,OAAM,CACb,CAAC,CACL,EAEMU,EAAWF,GAAkB,CACjCZ,EACG,SAASe,GAAe,CAAI,MAAAH,CAAK,CAAA,EACjC,UAAS,EACT,KAAI,IAAO,CACVJ,EAAAJ,CAAI,EAAC,MAAK,EACVI,EAAAJ,CAAI,EAAC,OAAM,CACb,CAAC,CACL,sPAYyCK,CAAS,sLAH/CA,CAAS,GAAAO,EAAAC,CAAA,sJAYqBP,EAAK,EAAC,MAAM,SAAO,EAAA,EAAA,CAAA,4CAYvCA,EAAK,EAAC,KAAK,kBAAkB,KAAQQ,GAAKA,EAAI,EAAE,IAAhD,IAAAC,GAAAC,EAAA,EAAA,IAAAV,EAAK,EAAC,KAAK,kBAAkB,KAAQQ,GAAKA,EAAI,MAATA,IAAG,gIAStBP,EAAUH,EAACU,CAAG,EAAC,EAAE,6BAGjBJ,EAAON,EAACU,CAAG,EAAC,EAAE,sCAV9BG,EAAAC,GAAAd,EAAAU,CAAG,EAAC,IAAI,EACRG,EAAAE,GAAAf,EAAAU,CAAG,EAAC,iBAAiB,WAUqDM,GAAAC,GAAA,OAAAC,GAAO,QAAOlB,EAAGU,CAAG,EAAC,EAAE,QATjGS,GAAUnB,EAACU,CAAG,EAAC,UAAU,CAAA,2DAjB9BR,EAAK,EAAC,MAAKM,EAAAY,CAAA,EAAAZ,EAAAa,EAAA,EAAA,2CAFhBnB,EAAK,EAAC,SAAQM,EAAAc,EAAA,EAAAd,EAAAe,GAAA,EAAA,yGA0CsBtB,CAAS,wLAH/CA,CAAS,GAAAO,EAAAgB,EAAA,mDAxDd"}