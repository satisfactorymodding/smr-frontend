import{I as De,a as Fe,p as Ie,X as Pe,ar as Te,aq as qe,as as we,J as Ee,f as Le,g as f,k as _,h as d,m as l,q as n,r as Qe,t as Ge,O as Oe,n as H,L as A,C as Me,F as v,y as m,G as je,D as L,R as C,_ as K,a0 as V,au as D,a5 as F,a9 as ze,u as t,T as Je,a6 as Q,ab as Ne,ac as Re,ag as W,Z as G,j as Ue,M as Y,A as ee,ad as te,a2 as O,av as Xe,z as ae}from"../chunks/aDZdp7_x.js";import{c as Ze,d as Be,e as He,f as Ke}from"../chunks/Bj1PSOzY.js";import{t as b}from"../chunks/Ci59I3ld.js";s[v]="src/routes/admin/satisfactory-versions/+page.svelte";var Ve=f(m('<h1 class="svelte-1xd3fmf">Loading satisfactory versions...</h1>'),s[v],[[151,4]]),We=f(m('<h1 class="svelte-1xd3fmf"> </h1>'),s[v],[[153,4]]),Ye=f(m('<div><div>Game CL#</div> <input type="text" class="input p-2" placeholder="Version"/> <div>Engine Version</div> <input type="text" class="input p-2" placeholder="Engine version"/></div> <button class="btn border border-error-500 preset-tonal-error"><span>Delete</span></button>',1),s[v],[[162,12,[[163,14],[164,14],[171,14],[172,14]]],[180,12,[[183,14]]]]),et=f(m("<!> <!>",1),s[v],[]),tt=f(m('<!> <section class="p-4"><button class="btn border border-primary-500 preset-tonal-primary"><span>Add new Satisfactory version</span> <span class="material-icons">add</span></button></section>',1),s[v],[[190,4,[[191,6,[[192,8],[193,8]]]]]]),at=f(m('<h1 class="svelte-1xd3fmf">Satisfactory Versions</h1> <div class="card preset-filled-surface-100-900"><!></div>',1),s[v],[[147,0],[149,0]]);function s(se,re){Fe(new.target),Ie(re,!0,s);const S=()=>(je(j,"satisfactoryVersionsQuery"),Me(j,"$satisfactoryVersionsQuery",oe)),[oe,ne]=Ge(),x=Pe(),M={},g=Te(qe({}),"versionFields"),j=we({query:Ze,client:x});let o=Ee(Oe(()=>S().data?.getSatisfactoryVersions||[]),"satisfactoryVersions");function ie(){if(t(o).find(e=>e.id<0))M[t(o)[t(o).length-1].id].setOpen(!0),g[t(o)[t(o).length-1].id].focus();else{const e={id:-1,version:0,engine_version:"4.26"};t(o).push(e),ae(o,t(o)),setTimeout(()=>{M[e.id].setOpen(!0);const a=g[e.id];a.focus(),a.getElement().querySelectorAll("input")[0].select()},0)}}async function z(e){if(ee(e.version,0))return;console.log(...te("log",e));let a=!1;if(e.id<0){try{const c=(await O(x.mutation(Be,{satisfactoryVersion:{version:e.version,engine_version:e.engine_version}}).toPromise()))();c.data&&(e.id=c.data.createSatisfactoryVersion.id,a=!0)}catch(c){console.log(...te("log",c))}if(!a){b.error({description:`Failed to create Satisfactory version '${e.version}'!`,duration:2e3});return}}else{try{a=Xe((await O(x.mutation(He,{id:e.id,satisfactoryVersion:{version:e.version,engine_version:e.engine_version}}).toPromise()))().data.updateSatisfactoryVersion,null,!1)}catch{}if(!a){b.error({description:`Failed to update Satisfactory version '${e.version}'!`,duration:2e3});return}}b.success({description:`Satisfactory version '${e.version}' saved!`,duration:2e3})}async function ce(e){if(!(e.id<0)){let a=!1;try{a=(await O(x.mutation(Ke,{satisfactoryVersionID:e.id}).toPromise()))().data.deleteSatisfactoryVersion,a&&ae(o,t(o).filter(I=>ee(I.id,e.id,!1)))}catch{a=!1}if(!a){b.error({description:`Failed to remove Satisfactory version '${e.version}'!`,duration:2e3});return}}b.success({description:`Satisfactory version '${e.version}' removed!`,duration:2e3})}function de(e,a){e.stopPropagation(),ce(a)}var le={...Le()},J=at(),N=_(d(J),2),ve=A(N);{var ue=e=>{var a=Ve();n(e,a)},pe=e=>{var a=L(),c=d(a);{var I=u=>{var p=We(),k=A(p);C(p),K(()=>V(k,`Failed to load satisfactory versions: ${S().error.message??""}`)),n(u,p)},fe=u=>{var p=tt(),k=d(p);l(()=>D(k,{children:F(s,(ge,st)=>{var U=L(),he=d(U);ze(()=>t(o),h=>h.id),l(()=>Je(he,17,()=>t(o),h=>h.id,(h,r,rt)=>{var X=L(),$e=d(X);l(()=>Q($e,()=>D.Item,(ye,be)=>{be(ye,{get value(){return t(r).id},children:F(s,(Se,ot)=>{var Z=et(),B=d(Z);l(()=>Q(B,()=>D.ItemTrigger,(P,T)=>{T(P,{children:F(s,(q,ke)=>{Ne();var $=Re();K(()=>V($,t(r).version)),n(q,$)}),$$slots:{default:!0}})}),"component",s,158,10,{componentTag:"Accordion.ItemTrigger"});var xe=_(B,2);l(()=>Q(xe,()=>D.ItemContent,(P,T)=>{T(P,{children:F(s,(q,ke)=>{var $=Ye(),w=d($),y=_(A(w),2);W(y),y.__change=()=>z(t(r)),G("bind:value={satisfactoryVersion.version}",()=>t(r),()=>"version",167,16),G("bind:this={versionFields[satisfactoryVersion.id]}",()=>g,()=>t(r).id,169,16),Ue(y,(i,Ce)=>g[Ce.id]=i,i=>g?.[i.id],()=>[t(r)]);var E=_(y,4);W(E),E.__change=()=>z(t(r)),G("bind:value={satisfactoryVersion.engine_version}",()=>t(r),()=>"engine_version",175,16),C(w);var Ae=_(w,2);Ae.__click=i=>de(i,t(r)),Y(y,()=>t(r).version,i=>t(r).version=i),Y(E,()=>t(r).engine_version,i=>t(r).engine_version=i),n(q,$)}),$$slots:{default:!0}})}),"component",s,161,10,{componentTag:"Accordion.ItemContent"}),n(Se,Z)}),$$slots:{default:!0}})}),"component",s,157,8,{componentTag:"Accordion.Item"}),n(h,X)}),"each",s,156,6),n(ge,U)}),$$slots:{default:!0}}),"component",s,155,4,{componentTag:"Accordion"});var R=_(k,2),me=A(R);me.__click=ie,C(R),n(u,p)};l(()=>H(c,u=>{S().error?u(I):u(fe,!1)},!0),"if",s,152,2)}n(e,a)};l(()=>H(ve,e=>{S().fetching?e(ue):e(pe,!1)}),"if",s,150,2)}C(N),n(se,J);var _e=Qe(le);return ne(),_e}De(["change","click"]);export{s as component};
//# sourceMappingURL=5.lvyO1Op3.js.map
