import{a as Qa,p as Ya,X as Ra,b as ia,J as Fa,N as ae,O as oa,f as ee,g as f,m as y,n as j,k as v,L as a,al as te,x as Va,C as la,u as $,am as se,a0 as x,a1 as p,q as _,r as re,t as ne,G as va,F as c,y as b,w as ie,z as $a,h as pa,S as e,ab as P,A as ua,a9 as Sa,U as ja}from"./C90Be9iR.js";import{o as oe,s as Ma,a as le,b as ve,d as ka,c as pe,v as ue,r as ge}from"./Cd1t7oD7.js";import{J as me}from"./DBb6gfiw.js";import{v as ce}from"./DIHUSRtE.js";import{T as Ta,V as de}from"./C2xQDKU4.js";import{t as _e}from"./BUBXjO2D.js";import{b as fe}from"./DomivD8e.js";import{F as be}from"./DUUkaumO.js";import{F as he}from"./Cio0SLrs.js";const xe=Object.keys(Ta).map(m=>Ta[m]).filter(m=>typeof m=="string"),Na=async(m,r)=>{const l=await ce(m);if(l.length!=0)return{message:`invalid ${r}.uplugin`,extended:l};const n=JSON.parse(m),u=n.Plugins?.some(M=>M.Name==="SML"),S=!!n.GameVersion;return!u&&!S?{message:`either GameVersion or SML dependency must be present in ${r}.uplugin`}:n};function ye(m){const r=m.split("/");return r[r.length-1]}function we(m){const r=m.split("/");return r.slice(0,r.length-1).join("/")}const Fe=[".so",".dll",".pak",".utoc",".ucas"],Ve=async(m,r)=>new me().loadAsync(m).then(async n=>{const u=n.filter(o=>ye(o)==r+".uplugin");if(u.length===0)return{message:"Mod does not contain any "+r+".uplugin files"};const S=Object.keys(n.files).filter(o=>Fe.some(w=>o.endsWith(w)));if(u.length===1&&u[0].name===r+".uplugin"){const o=await Na(await u[0].async("string"),r);return"message"in o?o:{uplugin:o,objects:S,targets:["Windows"]}}if(u.some(o=>o.name===r+".uplugin"))return{message:"Mod contains "+r+".uplugin files in the root directory. New uploads must use the multi-target format. Read more on the docs: https://docs.ficsit.app/satisfactory-modding/latest/Development/UpdatingToDedi.html"};const M=u.map(o=>we(o.name)),G=M.filter(o=>!xe.includes(o));if(G.length!==0)return{message:`invalid target(s): ${G.join(", ")}`};const Z=n.filter(o=>!M.some(w=>o.startsWith(w+"/")));if(Z.length!==0)return{message:`file(s) outside target directories: ${Z.map(o=>o.name).join(", ")}`};const U=await Promise.all(u.map(o=>o.async("string").catch(w=>{throw new Error(`invalid ${r}.uplugin: ${w}`)})));if(!U.every(o=>o===U[0]))return{message:"Mod contains "+r+".uplugin files with different contents"};const A=await Na(U[0],r);return"message"in A?A:{uplugin:A,objects:S,targets:M}}).catch(n=>({message:"invalid zip/smod file: "+n})),$e=(m,r)=>oe({file:le(ve().superRefine(async(l,n)=>{if(!("name"in l&&"size"in l&&"type"in l)){n.addIssue({message:"Unknown file error",code:ka.custom});return}const u=await Ve(l,m);if("message"in u){n.addIssue({message:u.message,code:ka.custom});return}r.set(u)})),changelog:Ma(),stability:Ma()});s[c]="src/lib/components/versions/VersionForm.svelte";var Se=f(b("<div><span><strong> </strong> </span><br/> <span><strong> </strong> </span></div>"),s[c],[[61,8,[[62,10,[[62,16]]],[62,89],[63,10,[[63,16]]]]]]),je=f(b("<span><strong>SemVersion:</strong> <br/></span>"),s[c],[[73,14,[[73,20],[73,78]]]]),Me=f(b('<span class="text-yellow-600"> </span>'),s[c],[[75,14]]),ke=f(b("<span><strong>Game version:</strong> <br/></span>"),s[c],[[82,14,[[82,20],[82,81]]]]),Te=f(b('<span class="text-yellow-600"> </span>'),s[c],[[84,14]]),Ne=f(b("<span> </span>"),s[c],[[98,18]]),Pe=f(b("<span>*</span>"),s[c],[[100,18]]),Ge=f(b("<strong> </strong> <!> <br/>",1),s[c],[[96,16],[102,16]]),De=f(b("<p><strong> </strong><br/> <!></p>"),s[c],[[93,12,[[94,14],[94,52]]]]),Le=f(b("<span> </span> <br/>",1),s[c],[[111,16],[112,16]]),ze=f(b("<p><strong> </strong><br/> <!></p>"),s[c],[[108,12,[[109,14],[109,47]]]]),Ee=f(b('<p><span class="text-yellow-600"> </span></p>'),s[c],[[116,12,[[117,14]]]]),Ue=f(b('<div><p class="mb-4"><span><strong> </strong> <br/></span> <!> <!></p> <span><strong>Targets:</strong> <br/></span> <!> <!></div>'),s[c],[[68,8,[[69,10,[[70,12,[[70,18],[70,78]]]]],[90,10,[[90,16],[90,71]]]]]]),Ae=f(b("<!> <!> <!>",1),s[c],[]),Ie=f(b('<form><div class="grid grid-flow-row gap-6"><!> <!> <div class="text-muted"> <a href="/content-policy" class="svelte-pxq5v4"> </a>.</div> <div><button class="btn border border-primary-500 preset-tonal-primary" type="submit"><span class="material-icons pr-2"> </span> </button></div></div></form>'),s[c],[[55,0,[[56,2,[[128,4,[[129,40]]],[132,4,[[133,6,[[134,8]]]]]]]]]]);function s(m,r){Qa(new.target),Ya(r,!0,s);const l=()=>(va(G,"t"),la(G,"$t",S)),n=()=>(va(o,"modMeta"),la(o,"$modMeta",S)),u=()=>(va(X,"data"),la(X,"$data",S)),[S,M]=ne(),{t:G}=Ra();let Z=ia(r,"initialValues",19,()=>({changelog:"",stability:de.Release})),U=ia(r,"submitText",19,()=>l()("entry.create")),A=ia(r,"editing",3,!1);const o=ie();let w=Fa(ae(!1),"disabled");const ga=$e(r.modReference,o),{form:Pa,data:X}=pe({initialValues:Z(),extend:[ue({schema:ga}),ge],onSubmit:h=>{$a(w,!0),r.onSubmit(_e(h,ga)).then(()=>$a(w,!1))}});let ma=Fa(oa(()=>n()?.uplugin?.Plugins?.filter(h=>!h.BasePlugin)||[]),"dependencies");var Ga={get t(){return G},...ee()},B=Ie(),ca=a(B),da=a(ca);{var Da=h=>{var D=Ae(),xa=pa(D);{let F=oa(()=>l()("file"));y(()=>be(xa,{get label(){return`${$(F)??""} *`},name:"file",id:"file",accept:".zip,.smod",placeholder:"File"}),"component",s,58,6,{componentTag:"FormFileField"})}var ya=v(xa,2);{var Aa=F=>{var k=Se(),T=a(k),N=a(T),I=a(N);e(N);var Y=v(N);e(T);var C=v(T,3),L=a(C),R=a(L);e(L);var aa=v(L);e(C),e(k),x((ea,ta,sa)=>{p(I,`${ea??""}:`),p(Y,` ${u().file.type||"Unknown"}`),p(R,`${ta??""}:`),p(aa,` ${sa??""}`)},[()=>l()("file-type"),()=>l()("file-size"),()=>fe(u().file.size)]),_(F,k)};y(()=>j(ya,F=>{u().file&&F(Aa)}),"if",s,60,6)}var Ia=v(ya,2);{var Ja=F=>{var k=Ue(),T=a(k),N=a(T),I=a(N),Y=a(I);e(I);var C=v(I);P(),e(N);var L=v(N,2);{var R=i=>{var t=je(),g=v(a(t));P(),e(t),x(()=>p(g,` ${n().uplugin.SemVersion??""}`)),_(i,t)},aa=i=>{var t=Me(),g=a(t);e(t),x(V=>p(g,`${V??""}
                ${n().uplugin.Version??""}.0.0`),[()=>l()("version-form.missing-sem-version")]),_(i,t)};y(()=>j(L,i=>{ua(n().uplugin.SemVersion,void 0,!1)?i(R):i(aa,!1)}),"if",s,72,12)}var ea=v(L,2);{var ta=i=>{var t=ke(),g=v(a(t));P(),e(t),x(()=>p(g,` ${n().uplugin.GameVersion??""}`)),_(i,t)},sa=i=>{var t=Te(),g=a(t,!0);e(t),x(V=>p(g,V),[()=>l()("version-form.missing-game-version")]),_(i,t)};y(()=>j(ea,i=>{ua(n().uplugin.GameVersion,void 0,!1)?i(ta):i(sa,!1)}),"if",s,81,12)}e(T);var ra=v(T,2),Oa=v(a(ra));P(),e(ra);var wa=v(ra,2);{var qa=i=>{var t=De(),g=a(t),V=a(g);e(g);var J=v(g,3);Sa(()=>$(ma),d=>d.Name),y(()=>ja(J,17,()=>$(ma),d=>d.Name,(d,O)=>{var q=Ge(),z=pa(q),na=a(z);e(z);var Ca=v(z,2);{var Xa=E=>{var W=Ne(),Ka=a(W,!0);e(W),x(()=>p(Ka,$(O).SemVersion)),_(E,W)},Ha=E=>{var W=Pe();_(E,W)};y(()=>j(Ca,E=>{$(O).SemVersion?E(Xa):E(Ha,!1)}),"if",s,97,16)}P(2),x(()=>p(na,`${$(O).Name??""}:`)),_(d,q)}),"each",s,95,14),e(t),x(d=>p(V,`${d??""}:`),[()=>l()("dependencies")]),_(i,t)};y(()=>j(wa,i=>{ua(n().uplugin.Plugins,void 0,!1)&&i(qa)}),"if",s,92,10)}var Wa=v(wa,2);{var Za=i=>{var t=ze(),g=a(t),V=a(g);e(g);var J=v(g,3);Sa(()=>n().objects,d=>d),y(()=>ja(J,1,()=>n().objects,d=>d,(d,O)=>{var q=Le(),z=pa(q),na=a(z,!0);e(z),P(2),x(()=>p(na,$(O))),_(d,q)}),"each",s,110,14),e(t),x(d=>p(V,`${d??""}:`),[()=>l()("objects")]),_(i,t)},Ba=i=>{var t=Ee(),g=a(t),V=a(g,!0);e(g),e(t),x(J=>p(V,J),[()=>l()("version-form.missing-sem-version")]),_(i,t)};y(()=>j(Wa,i=>{n().objects&&n().objects.length>0?i(Za):i(Ba,!1)}),"if",s,107,10)}e(k),x((i,t)=>{p(Y,`${i??""}:`),p(C,` ${n().uplugin.Version??""}`),p(Oa,` ${t??""}`)},[()=>l()("version"),()=>n().targets.join(", ")]),_(F,k)};y(()=>j(Ia,F=>{n()&&F(Ja)}),"if",s,67,6)}_(h,D)};y(()=>j(da,h=>{A()||h(Da)}),"if",s,57,4)}var _a=v(da,2);{let h=oa(()=>l()("changelog"));y(()=>he(_a,{get label(){return $(h)},name:"changelog",required:!0,get value(){return u().changelog},set value(D){te(X,Va(u).changelog=D,Va(u))}}),"component",s,126,4,{componentTag:"FormMarkdownField"})}var H=v(_a,2),fa=a(H),ba=v(fa),La=a(ba,!0);e(ba),P(),e(H);var ha=v(H,2),K=a(ha),Q=a(K),za=a(Q,!0);e(Q);var Ea=v(Q);e(K),e(ha),e(ca),e(B),se(B,h=>Pa?.(h)),x((h,D)=>{p(fa,`${h??""} `),p(La,D),K.disabled=$(w),p(za,r.submitIcon),p(Ea,` ${U()??""}`)},[()=>l()("version-form.agreement-to"),()=>l()("content-policy")]),_(m,B);var Ua=re(Ga);return M(),Ua}export{s as V};
//# sourceMappingURL=B3mGc4Qb.js.map
