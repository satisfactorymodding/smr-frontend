import{a as Ge,p as We,X as Ze,Y as tt,J as qe,O as U,aw as rt,f as Je,D as me,h as j,m as a,n as O,C as he,q as c,r as Oe,t as Ye,G as be,u as n,g as $,L as l,S as d,a0 as V,a1 as X,F as _,y as T,I as at,b as Ue,N as Ee,au as ot,ax as Ae,al as f,x as o,k as i,z as ze,aM as x,a4 as re,am as nt,a6 as N,ab as He,ac as Ne,a9 as st,U as it,an as lt,A as Ve,M as dt}from"./DXyKL7ev.js";import{o as ce,a as J,e as ct,s as h,l as mt,b as ut,c as pt,v as vt,r as _t}from"./cOqIQ9UF.js";import{t as gt}from"./DsD2_0M_.js";import{I as ft,x as Xe}from"./C2xQDKU4.js";import{U as ht}from"./BwSO8-fW.js";import{T as bt}from"./BygCr7L5.js";import{M as yt}from"./f4OV-Bj0.js";import{F as fe}from"./BH2B-EM1.js";import{F as $t}from"./D_2gKbnE.js";import{F as Tt}from"./C_rRi3OF.js";const je=ce({name:h().min(3).max(32),mod_reference:h().min(3).max(32).regex(/^([a-zA-Z][a-zA-Z0-9_]*)$/).refine(async()=>!0),short_description:h().min(16).max(128),full_description:J(h()),logo:J(ut().refine(G=>"name"in G&&"size"in G&&"type"in G)),source_url:h().url().optional().or(mt("")),authors:J(ce({role:h(),user_id:h()}).array()),compatibility:J(ce({EA:ce({state:h(),note:J(h())}),EXP:ce({state:h(),note:J(h())})})),hidden:ct(),tagIDs:J(h().array())});y[_]="src/lib/components/mods/ModAuthor.svelte";var wt=$(T('<p class="mr-2"> </p>'),y[_],[[27,2]]),xt=$(T('<p class="mr-2"> </p>'),y[_],[[29,2]]),Ft=$(T('<div class="mr-2"><!></div>'),y[_],[[31,2]]),kt=$(T('<p class="mr-2 whitespace-nowrap">Unknown User ID</p>'),y[_],[[39,2]]);function y(G,A){Ge(new.target),We(A,!0,y);const s=()=>(be(n(ue),"user"),he(n(ue),"$user",ae)),e=()=>(be(W,"t"),he(W,"$t",ae)),[ae,ye]=Ye(),{t:W}=Ze(),$e=tt();let ue=qe(U(()=>rt({query:ft,client:$e,variables:{user:A.id}})),"user");var Y={get t(){return W},...Je()},pe=me(),m=j(pe);{var B=q=>{var w=wt(),oe=l(w);d(w),V(L=>X(oe,`${L??""}...`),[()=>e()("loading")]),c(q,w)},Te=q=>{var w=me(),oe=j(w);{var L=F=>{var k=xt(),K=l(k);d(k),V(Q=>X(K,`${Q??""}... ${s().error.message??""}`),[()=>e()("error.oh-no")]),c(F,k)},ve=F=>{var k=me(),K=j(k);{var Q=D=>{var P=Ft(),_e=l(P);{let se=U(()=>({id:s().data.getUser.id,username:s().data.getUser.username,avatar:s().data.getUser.avatar}));a(()=>ht(_e,{get user(){return n(se)},size:"small",showLink:!1,gap:"small"}),"component",y,32,4,{componentTag:"UserDisplay"})}d(P),c(D,P)},ne=D=>{var P=kt();c(D,P)};a(()=>O(K,D=>{s().data.getUser?D(Q):D(ne,!1)},!0),"if",y,30,0)}c(F,k)};a(()=>O(oe,F=>{s().error?F(L):F(ve,!1)},!0),"if",y,28,0)}c(q,w)};a(()=>O(m,q=>{s().fetching?q(B):q(Te,!1)}),"if",y,26,0)}c(G,pe);var we=Oe(Y);return ye(),we}t[_]="src/lib/components/mods/ModForm.svelte";var St=$(T("<!> <!> <!>",1),t[_],[]),Ct=$(T("<!> <!> <!>",1),t[_],[]),It=$(T('<div class="p-2"><!></div>'),t[_],[[166,14]]),Mt=$(T('<button class="btn border border-primary-500 preset-tonal-primary" type="button"><span> </span></button>'),t[_],[[180,14,[[184,16]]]]),Ut=$(T('<div class="flex items-end"><!> <label class="label"><span>User ID</span> <input type="text" required class="input p-2"/></label> <!></div>'),t[_],[[164,10,[[170,12,[[171,14],[172,14]]]]]]),At=$(T('<div><!></div> <!> <div class="grid grid-flow-row gap-2"><div class="flex items-center"><h4 class="mr-4"> </h4> <button class="btn border border-primary-500 preset-tonal-primary" type="button"><span> </span></button></div> <!></div>',1),t[_],[[142,6],[156,6,[[157,8,[[158,10],[159,10,[[160,12]]]]]]]]),qt=$(T('<form><div class="grid grid-flow-row gap-6"><!> <!> <!> <!> <div class="grid grid-flow-row gap-2"><!></div> <!> <!> <div class="grid grid-flow-row gap-2"><!></div> <!> <div><button class="btn border border-primary-500 preset-tonal-primary" type="submit"> </button></div></div></form>'),t[_],[[95,0,[[96,2,[[119,4],[132,4],[192,4,[[193,6]]]]]]]]);function t(G,A){Ge(new.target),We(A,!0,t);const s=()=>(be(W,"t"),he(W,"$t",ae)),e=()=>(be(m,"data"),he(m,"$data",ae)),[ae,ye]=Ye(),{t:W}=Ze();let $e=Ue(A,"initialValues",19,()=>({full_description:"",mod_reference:"",name:"",short_description:"",source_url:"",hidden:!1,tagIDs:[],compatibility:{EA:{state:Xe.Works,note:""},EXP:{state:Xe.Works,note:""}}})),ue=Ue(A,"submitText",19,()=>s()("entry.create")),Y=Ue(A,"editing",3,!1);const{form:pe,data:m}=pt({initialValues:$e(),extend:[vt({schema:je}),_t],onSubmit:r=>A.onSubmit(gt(r,je))});let B=qe(Ee(ot(e().tags)),"tags");const Te=()=>{f(m,o(e).tagIDs=n(B).map(r=>r.id),o(e))};Ae(()=>{n(B)&&Te()}),Ae(()=>{Y()||delete e().compatibility});const we=()=>{e().authors.push({role:"editor",user_id:"",key:""}),f(m,o(e).authors=e().authors,o(e))},q=r=>{e().authors.splice(r,1),f(m,o(e).authors=e().authors,o(e))};let w=qe(Ee(!1),"editCompatibility");Ae(()=>{f(m,o(e).compatibility=e().compatibility?e().compatibility:void 0,o(e))});var oe={get t(){return W},...Je()},L=qt(),ve=l(L),F=l(ve);{let r=U(()=>s()("entry.name"));a(()=>fe(F,{get label(){return n(r)},name:"name",required:!0,get value(){return e().name},set value(v){f(m,o(e).name=v,o(e))}}),"component",t,97,4,{componentTag:"FormField"})}var k=i(F,2);{let r=U(()=>s()("mod.reference")),v=U(()=>Y()?void 0:s()("mod.reference-warning"));a(()=>fe(k,{get label(){return n(r)},name:"mod_reference",required:!0,get disabled(){return Y()},get helperText(){return n(v)},get value(){return e().mod_reference},set value(E){f(m,o(e).mod_reference=E,o(e))}}),"component",t,99,4,{componentTag:"FormField"})}var K=i(k,2);{let r=U(()=>s()("entry.short-description"));a(()=>fe(K,{get label(){return n(r)},name:"short_description",required:!0,get value(){return e().short_description},set value(v){f(m,o(e).short_description=v,o(e))}}),"component",t,107,4,{componentTag:"FormField"})}var Q=i(K,2);{let r=U(()=>s()("entry.full-description"));a(()=>$t(Q,{get label(){return n(r)},name:"full_description",required:!0,get value(){return e().full_description},set value(v){f(m,o(e).full_description=v,o(e))}}),"component",t,113,4,{componentTag:"FormMarkdownField"})}var ne=i(Q,2),D=l(ne);a(()=>bt(D,{editable:!0,get tags(){return n(B)},set tags(r){ze(B,r,!0)}}),"component",t,120,6,{componentTag:"TagList"}),d(ne);var P=i(ne,2);{let r=U(()=>s()("logo"));a(()=>Tt(P,{get label(){return`${n(r)??""}:`},name:"logo",id:"logo",accept:"image/png,image/jpeg,image/gif",placeholder:"Logo"}),"component",t,123,4,{componentTag:"FormFileField"})}var _e=i(P,2);{let r=U(()=>s()("entry.source-url"));a(()=>fe(_e,{get label(){return n(r)},name:"source_url",required:!0,get value(){return e().source_url},set value(v){f(m,o(e).source_url=v,o(e))}}),"component",t,130,4,{componentTag:"FormField"})}var se=i(_e,2),Be=l(se);a(()=>x(Be,{get checked(){return e().hidden},onCheckedChange:r=>f(m,o(e).hidden=r.checked,o(e)),children:re(t,(r,v)=>{var E=St(),ge=j(E);a(()=>N(ge,()=>x.Control,(z,S)=>{S(z,{children:re(t,(Z,Fe)=>{var C=me(),R=j(C);a(()=>N(R,()=>x.Thumb,(ke,Se)=>{Se(ke,{})}),"component",t,135,10,{componentTag:"Switch.Thumb"}),c(Z,C)}),$$slots:{default:!0}})}),"component",t,134,8,{componentTag:"Switch.Control"});var ie=i(ge,2);a(()=>N(ie,()=>x.Label,(z,S)=>{S(z,{children:re(t,(Z,Fe)=>{He();var C=Ne();V(R=>X(C,R),[()=>s()("entry.hidden")]),c(Z,C)}),$$slots:{default:!0}})}),"component",t,137,8,{componentTag:"Switch.Label"});var xe=i(ie,2);a(()=>N(xe,()=>x.HiddenInput,(z,S)=>{S(z,{})}),"component",t,138,8,{componentTag:"Switch.HiddenInput"}),c(r,E)}),$$slots:{default:!0}}),"component",t,133,6,{componentTag:"Switch"}),d(se);var Le=i(se,2);{var Ke=r=>{var v=At(),E=j(v),ge=l(E);a(()=>x(ge,{get checked(){return n(w)},onCheckedChange:u=>ze(w,u.checked,!0),children:re(t,(u,b)=>{var H=Ct(),ee=j(H);a(()=>N(ee,()=>x.Control,(I,M)=>{M(I,{children:re(t,(de,Ie)=>{var p=me(),g=j(p);a(()=>N(g,()=>x.Thumb,(te,Me)=>{Me(te,{})}),"component",t,145,12,{componentTag:"Switch.Thumb"}),c(de,p)}),$$slots:{default:!0}})}),"component",t,144,10,{componentTag:"Switch.Control"});var le=i(ee,2);a(()=>N(le,()=>x.Label,(I,M)=>{M(I,{children:re(t,(de,Ie)=>{He();var p=Ne();V(g=>X(p,g),[()=>s()("compatibility-info.edit")]),c(de,p)}),$$slots:{default:!0}})}),"component",t,147,10,{componentTag:"Switch.Label"});var Ce=i(le,2);a(()=>N(Ce,()=>x.HiddenInput,(I,M)=>{M(I,{})}),"component",t,148,10,{componentTag:"Switch.HiddenInput"}),c(u,H)}),$$slots:{default:!0}}),"component",t,143,8,{componentTag:"Switch"}),d(E);var ie=i(E,2);{var xe=u=>{a(()=>yt(u,{get compatibilityInfo(){return e().compatibility},set compatibilityInfo(b){f(m,o(e).compatibility=b,o(e))}}),"component",t,153,8,{componentTag:"ModCompatibility"})};a(()=>O(ie,u=>{n(w)&&u(xe)}),"if",t,152,6)}var z=i(ie,2),S=l(z),Z=l(S),Fe=l(Z,!0);d(Z);var C=i(Z,2);C.__click=we;var R=l(C),ke=l(R,!0);d(R),d(C),d(S);var Se=i(S,2);st(()=>e().authors,(u,b)=>u.key||b),a(()=>it(Se,3,()=>e().authors,(u,b)=>u.key||b,(u,b,H)=>{var ee=Ut(),le=l(ee);{var Ce=p=>{var g=It(),te=l(g);a(()=>y(te,{get id(){return e().authors[n(H)].user_id}}),"component",t,167,16,{componentTag:"ModAuthor"}),d(g),c(p,g)};a(()=>O(le,p=>{e().authors[n(H)].user_id&&p(Ce)}),"if",t,165,12)}var I=i(le,2),M=i(l(I),2);lt(M),d(I);var de=i(I,2);{var Ie=p=>{var g=Mt();g.__click=()=>q(n(H));var te=l(g),Me=l(te,!0);d(te),d(g),V(et=>X(Me,et),[()=>s()("remove")]),c(p,g)};a(()=>O(de,p=>{Ve(n(b).role,"creator",!1)&&p(Ie)}),"if",t,179,12)}d(ee),V(()=>M.disabled=Ve(n(b).role,"creator")),dt(M,()=>e().authors[n(H)].user_id,p=>f(m,o(e).authors[n(H)].user_id=p,o(e))),c(u,ee)}),"each",t,163,8),d(z),V((u,b)=>{X(Fe,u),X(ke,b)},[()=>s()("authors"),()=>s()("add")]),c(r,v)};a(()=>O(Le,r=>{Y()&&r(Ke)}),"if",t,141,4)}var De=i(Le,2),Pe=l(De),Qe=l(Pe,!0);d(Pe),d(De),d(ve),d(L),nt(L,r=>pe?.(r)),V(()=>X(Qe,ue())),c(G,L);var Re=Oe(oe);return ye(),Re}at(["click"]);export{t as M};
//# sourceMappingURL=lP3m-nn-.js.map
