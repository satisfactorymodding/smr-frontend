import{a as ue,p as me,W as _e,b as _a,C as fa,J as ba,N as fe,z as Fa,O as Ga,f as be,g as m,L as a,m as w,n as D,k as i,R as e,S as he,ap as xe,a5 as Da,a8 as La,_ as h,a0 as l,q as u,P as we,Q as ye,u as N,ab as q,ah as Ve,M as $e,ai as Se,x as qa,r as Me,t as je,G as ha,w as ke,h as xa,F as d,y as _,A as wa,a9 as za,T as Ea}from"./aDZdp7_x.js";import{o as Te,s as Aa,a as Pe,b as Ne,d as Ia,c as Fe,v as Ge,r as De,V as Ja}from"./CJ6n3RUw.js";import{J as Le}from"./BrWz2MdB.js";import{v as qe}from"./DPw_V1B2.js";import{T as Oa,V as ze}from"./Bj1PSOzY.js";import{t as Ee}from"./BkiHy3_f.js";import{m as Ae}from"./CkAV2acv.js";import{b as Ie}from"./CwkDO0EH.js";const Je=Object.keys(Oa).map(b=>Oa[b]).filter(b=>typeof b=="string"),Ua=async(b,r)=>{const p=await qe(b);if(p.length!=0)return{message:`invalid ${r}.uplugin`,extended:p};const g=JSON.parse(b),n=g.Plugins?.some(L=>L.Name==="SML"),F=!!g.GameVersion;return!n&&!F?{message:`either GameVersion or SML dependency must be present in ${r}.uplugin`}:g};function Oe(b){const r=b.split("/");return r[r.length-1]}function Ue(b){const r=b.split("/");return r.slice(0,r.length-1).join("/")}const We=[".so",".dll",".pak",".utoc",".ucas"],Ze=async(b,r)=>new Le().loadAsync(b).then(async g=>{const n=g.filter(v=>Oe(v)==r+".uplugin");if(n.length===0)return{message:"Mod does not contain any "+r+".uplugin files"};const F=Object.keys(g.files).filter(v=>We.some(M=>v.endsWith(M)));if(n.length===1&&n[0].name===r+".uplugin"){const v=await Ua(await n[0].async("string"),r);return"message"in v?v:{uplugin:v,objects:F,targets:["Windows"]}}if(n.some(v=>v.name===r+".uplugin"))return{message:"Mod contains "+r+".uplugin files in the root directory. New uploads must use the multi-target format. Read more on the docs: https://docs.ficsit.app/satisfactory-modding/latest/Development/UpdatingToDedi.html"};const L=n.map(v=>Ue(v.name)),z=L.filter(v=>!Je.includes(v));if(z.length!==0)return{message:`invalid target(s): ${z.join(", ")}`};const H=g.filter(v=>!L.some(M=>v.startsWith(M+"/")));if(H.length!==0)return{message:`file(s) outside target directories: ${H.map(v=>v.name).join(", ")}`};const J=await Promise.all(n.map(v=>v.async("string").catch(M=>{throw new Error(`invalid ${r}.uplugin: ${M}`)})));if(!J.every(v=>v===J[0]))return{message:"Mod contains "+r+".uplugin files with different contents"};const O=await Ua(J[0],r);return"message"in O?O:{uplugin:O,objects:F,targets:L}}).catch(g=>({message:"invalid zip/smod file: "+g})),Be=(b,r)=>Te({file:Pe(Ne().superRefine(async(p,g)=>{if(!("name"in p&&"size"in p&&"type"in p)){g.addIssue({message:"Unknown file error",code:Ia.custom});return}const n=await Ze(p,b);if("message"in n){g.addIssue({message:n.message,code:Ia.custom});return}r.set(n)})),changelog:Aa(),stability:Aa()});s[d]="src/lib/components/versions/VersionForm.svelte";var Ce=m(_('<span class="validation-message"> </span>'),s[d],[[63,12]]),Qe=m(_("<div><span><strong> </strong> </span><br/> <span><strong> </strong> </span></div>"),s[d],[[69,8,[[70,10,[[70,16]]],[70,89],[71,10,[[71,16]]]]]]),He=m(_("<span><strong>SemVersion:</strong> <br/></span>"),s[d],[[81,14,[[81,20],[81,78]]]]),Ke=m(_('<span class="text-yellow-600"> </span>'),s[d],[[83,14]]),Xe=m(_("<span><strong>Game version:</strong> <br/></span>"),s[d],[[90,14,[[90,20],[90,81]]]]),Ye=m(_('<span class="text-yellow-600"> </span>'),s[d],[[92,14]]),Re=m(_("<span> </span>"),s[d],[[106,18]]),as=m(_("<span>*</span>"),s[d],[[108,18]]),es=m(_("<strong> </strong> <!> <br/>",1),s[d],[[104,16],[110,16]]),ss=m(_("<p><strong> </strong><br/> <!></p>"),s[d],[[101,12,[[102,14],[102,52]]]]),ts=m(_("<span> </span> <br/>",1),s[d],[[119,16],[120,16]]),rs=m(_("<p><strong> </strong><br/> <!></p>"),s[d],[[116,12,[[117,14],[117,47]]]]),ns=m(_('<p><span class="text-yellow-600"> </span></p>'),s[d],[[124,12,[[125,14]]]]),is=m(_('<div><p class="mb-4"><span><strong> </strong> <br/></span> <!> <!></p> <span><strong>Targets:</strong> <br/></span> <!> <!></div>'),s[d],[[76,8,[[77,10,[[78,12,[[78,18],[78,78]]]]],[98,10,[[98,16],[98,71]]]]]]),os=m(_('<div class="grid grid-flow-row gap-2"><label for="file"> </label> <input id="file" class="base-input" name="file" type="file" accept=".zip,.smod" placeholder="File"/> <!></div> <!> <!>',1),s[d],[[58,6,[[59,8],[60,8]]]]),ls=m(_('<span class="validation-message"> </span>'),s[d],[[142,12]]),vs=m(_('<div class="markdown-content right svelte-pxq5v4"><!></div>'),s[d],[[150,10]]),ps=m(_('<form><div class="grid grid-flow-row gap-6"><!> <div class="split grid gap-6 svelte-pxq5v4"><div class="grid grid-flow-row auto-rows-max gap-2"><label class="label"><span> </span> <textarea class="vertical-textarea textarea p-2" required></textarea></label> <!></div> <div class="grid grid-flow-row auto-rows-max gap-2"><span> </span> <!></div></div> <div class="text-muted"> <a href="/content-policy" class="svelte-pxq5v4"> </a>.</div> <div><button class="btn border border-primary-500 preset-tonal-primary" type="submit"><span class="material-icons pr-2"> </span> </button></div></div></form>'),s[d],[[55,0,[[56,2,[[134,4,[[135,6,[[136,8,[[137,10],[138,10]]]]],[146,6,[[147,8]]]]],[155,4,[[156,40]]],[159,4,[[160,6,[[161,8]]]]]]]]]]);function s(b,r){ue(new.target),me(r,!0,s);const p=()=>(ha(z,"t"),fa(z,"$t",F)),g=()=>(ha(Y,"data"),fa(Y,"$data",F)),n=()=>(ha(v,"modMeta"),fa(v,"$modMeta",F)),[F,L]=je(),{t:z}=_e();let H=_a(r,"initialValues",19,()=>({changelog:"",stability:ze.Release})),J=_a(r,"submitText",19,()=>p()("entry.create")),O=_a(r,"editing",3,!1);const v=ke();let M=ba(fe(!1),"disabled");const ya=Be(r.modReference,v),{form:Wa,data:Y}=Fe({initialValues:H(),extend:[Ge({schema:ya}),De],onSubmit:f=>{Fa(M,!0),r.onSubmit(Ee(f,ya)).then(()=>Fa(M,!1))}});let Za=ba(Ga(()=>g().changelog||""),"preview"),Va=ba(Ga(()=>n()?.uplugin?.Plugins?.filter(f=>!f.BasePlugin)||[]),"dependencies");var Ba={get t(){return z},...be()},K=ps(),$a=a(K),Sa=a($a);{var Ca=f=>{var G=os(),y=xa(G),$=a(y),U=a($);e($);var la=i($,4);{const V=Da(s,function(j,k){La(...arguments);let S=()=>k?.().messages;S();var T=Ce(),W=a(T,!0);e(T),h(()=>l(W,S()||"")),u(j,T)});w(()=>Ja(la,{for:"file",children:V,$$slots:{default:!0}}),"component",s,61,8,{componentTag:"ValidationMessage"})}e(y);var Pa=i(y,2);{var se=V=>{var j=Qe(),k=a(j),S=a(k),T=a(S);e(S);var W=i(S);e(k);var X=i(k,3),E=a(X),va=a(E);e(E);var pa=i(E);e(X),e(j),h((ga,da,ca)=>{l(T,`${ga??""}:`),l(W,` ${g().file.type||"Unknown"}`),l(va,`${da??""}:`),l(pa,` ${ca??""}`)},[()=>p()("file-type"),()=>p()("file-size"),()=>Ie(g().file.size)]),u(V,j)};w(()=>D(Pa,V=>{g().file&&V(se)}),"if",s,68,6)}var te=i(Pa,2);{var re=V=>{var j=is(),k=a(j),S=a(k),T=a(S),W=a(T);e(T);var X=i(T);q(),e(S);var E=i(S,2);{var va=o=>{var t=He(),c=i(a(t));q(),e(t),h(()=>l(c,` ${n().uplugin.SemVersion??""}`)),u(o,t)},pa=o=>{var t=Ke(),c=a(t);e(t),h(P=>l(c,`${P??""}
                ${n().uplugin.Version??""}.0.0`),[()=>p()("version-form.missing-sem-version")]),u(o,t)};w(()=>D(E,o=>{wa(n().uplugin.SemVersion,void 0,!1)?o(va):o(pa,!1)}),"if",s,80,12)}var ga=i(E,2);{var da=o=>{var t=Xe(),c=i(a(t));q(),e(t),h(()=>l(c,` ${n().uplugin.GameVersion??""}`)),u(o,t)},ca=o=>{var t=Ye(),c=a(t,!0);e(t),h(P=>l(c,P),[()=>p()("version-form.missing-game-version")]),u(o,t)};w(()=>D(ga,o=>{wa(n().uplugin.GameVersion,void 0,!1)?o(da):o(ca,!1)}),"if",s,89,12)}e(k);var ua=i(k,2),ne=i(a(ua));q(),e(ua);var Na=i(ua,2);{var ie=o=>{var t=ss(),c=a(t),P=a(c);e(c);var Z=i(c,3);za(()=>N(Va),x=>x.Name),w(()=>Ea(Z,17,()=>N(Va),x=>x.Name,(x,B)=>{var C=es(),A=xa(C),ma=a(A);e(A);var pe=i(A,2);{var ge=I=>{var Q=Re(),ce=a(Q,!0);e(Q),h(()=>l(ce,N(B).SemVersion)),u(I,Q)},de=I=>{var Q=as();u(I,Q)};w(()=>D(pe,I=>{N(B).SemVersion?I(ge):I(de,!1)}),"if",s,105,16)}q(2),h(()=>l(ma,`${N(B).Name??""}:`)),u(x,C)}),"each",s,103,14),e(t),h(x=>l(P,`${x??""}:`),[()=>p()("dependencies")]),u(o,t)};w(()=>D(Na,o=>{wa(n().uplugin.Plugins,void 0,!1)&&o(ie)}),"if",s,100,10)}var oe=i(Na,2);{var le=o=>{var t=rs(),c=a(t),P=a(c);e(c);var Z=i(c,3);za(()=>n().objects,x=>x),w(()=>Ea(Z,1,()=>n().objects,x=>x,(x,B)=>{var C=ts(),A=xa(C),ma=a(A,!0);e(A),q(2),h(()=>l(ma,N(B))),u(x,C)}),"each",s,118,14),e(t),h(x=>l(P,`${x??""}:`),[()=>p()("objects")]),u(o,t)},ve=o=>{var t=ns(),c=a(t),P=a(c,!0);e(c),e(t),h(Z=>l(P,Z),[()=>p()("version-form.missing-sem-version")]),u(o,t)};w(()=>D(oe,o=>{n().objects&&n().objects.length>0?o(le):o(ve,!1)}),"if",s,115,10)}e(j),h((o,t)=>{l(W,`${o??""}:`),l(X,` ${n().uplugin.Version??""}`),l(ne,` ${t??""}`)},[()=>p()("version"),()=>n().targets.join(", ")]),u(V,j)};w(()=>D(te,V=>{n()&&V(re)}),"if",s,75,6)}h(V=>l(U,`${V??""} *`),[()=>p()("file")]),u(f,G)};w(()=>D(Sa,f=>{O()||f(Ca)}),"if",s,57,4)}var R=i(Sa,2),aa=a(R),ea=a(aa),sa=a(ea),Qa=a(sa);e(sa);var ta=i(sa,2);he(ta),xe(ta,"rows",10),e(ea);var Ha=i(ea,2);{const f=Da(s,function(G,y){La(...arguments);let $=()=>y?.().messages;$();var U=ls(),la=a(U,!0);e(U),h(()=>l(la,$()||"")),u(G,U)});w(()=>Ja(Ha,{for:"changelog",children:f,$$slots:{default:!0}}),"component",s,140,8,{componentTag:"ValidationMessage"})}e(aa);var Ma=i(aa,2),ra=a(Ma),Ka=a(ra);e(ra);var Xa=i(ra,2);w(()=>we(Xa,()=>Ae(N(Za)),null,(f,G)=>{var y=vs(),$=a(y);ye($,()=>N(G)),e(y),u(f,y)}),"await",s,148,8),e(Ma),e(R);var na=i(R,2),ja=a(na),ka=i(ja),Ya=a(ka,!0);e(ka),q(),e(na);var Ta=i(na,2),ia=a(Ta),oa=a(ia),Ra=a(oa,!0);e(oa);var ae=i(oa);e(ia),e(Ta),e($a),e(K),Ve(K,f=>Wa?.(f)),h((f,G,y,$)=>{l(Qa,`${f??""} *`),l(Ka,`${G??""}:`),l(ja,`${y??""} `),l(Ya,$),ia.disabled=N(M),l(Ra,r.submitIcon),l(ae,` ${J()??""}`)},[()=>p()("changelog"),()=>p()("preview"),()=>p()("version-form.agreement-to"),()=>p()("content-policy")]),$e(ta,()=>g().changelog,f=>Se(Y,qa(g).changelog=f,qa(g))),u(b,K);var ee=Me(Ba);return L(),ee}export{s as V};
//# sourceMappingURL=rMIg0gPT.js.map
