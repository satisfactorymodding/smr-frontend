{"version":3,"file":"CkAV2acv.js","sources":["../../../../../../src/lib/utils/markdown.ts"],"sourcesContent":["import DOMPurify from 'dompurify';\nimport { marked } from 'marked';\nimport { mangle } from 'marked-mangle';\nimport { browser } from '$app/environment';\nimport Prism from 'prismjs';\nimport 'prismjs/components/prism-c.js';\nimport 'prismjs/components/prism-cpp.js';\nimport 'prismjs/components/prism-lua.js';\nimport 'prismjs/components/prism-javascript.js';\nimport 'prismjs/components/prism-json.js';\nimport 'prismjs/components/prism-python.js';\nimport 'prismjs/components/prism-markdown.js';\nimport 'prismjs/components/prism-markup.js';\n\nmarked.use(mangle());\n\nlet resolver;\nconst sanitizer = new Promise<(string) => string>((r) => (resolver = r));\n\nif (!browser) {\n  (async () => {\n    const { JSDOM } = await import('jsdom');\n    resolver(DOMPurify(new JSDOM('').window).sanitize);\n  })();\n} else {\n  resolver(DOMPurify.sanitize);\n}\n\nexport const markdown = (md: string, inline = false): Promise<string> =>\n  sanitizer.then((s) => {\n    const sanitized = s(inline ? marked.parseInline(md) : marked(md));\n    const parsed = new DOMParser().parseFromString(sanitized, 'text/html');\n    Prism.highlightAllUnder(parsed.body);\n    return parsed.body.innerHTML;\n  });\n"],"names":["marked","mangle","resolver","sanitizer","r","DOMPurify","markdown","md","inline","s","sanitized","parsed","Prism"],"mappings":"uDAcAA,EAAO,IAAIC,GAAQ,EAEnB,IAAIC,EACJ,MAAMC,EAAY,IAAI,QAA6BC,GAAOF,EAAWE,CAAE,EAQrEF,EAASG,EAAU,QAAQ,EAGtB,MAAMC,EAAW,CAACC,EAAYC,EAAS,KAC5CL,EAAU,KAAMM,GAAM,CACpB,MAAMC,EAAYD,EAAED,EAASR,EAAO,YAAYO,CAAE,EAAIP,EAAOO,CAAE,CAAC,EAC1DI,EAAS,IAAI,UAAA,EAAY,gBAAgBD,EAAW,WAAW,EACrE,OAAAE,EAAM,kBAAkBD,EAAO,IAAI,EAC5BA,EAAO,KAAK,SACrB,CAAC"}