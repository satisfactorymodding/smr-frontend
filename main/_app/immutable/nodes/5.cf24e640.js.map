{"version":3,"file":"5.cf24e640.js","sources":["../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.ts","../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\n\nexport const load: PageLoad = async ({ params }) => ({\n  ...params\n});\n","<script lang=\"ts\">\n  import { getContextClient, queryStore } from '@urql/svelte';\n  import { GetSmlVersionAdminDocument, UpdateSmlVersionDocument } from '$lib/generated';\n  import Toast from '$lib/components/general/Toast.svelte';\n  import { goto } from '$app/navigation';\n  import type { SMLVersionData } from '$lib/models/sml-versions';\n  import SMLVersionForm from '$lib/components/sml-versions/SMLVersionForm.svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import Card, { Content } from '@smui/card';\n  import type { PageData } from './$types';\n\n  export let data: PageData;\n\n  $: ({ smlVersionId } = data);\n\n  const client = getContextClient();\n\n  let errorMessage = '';\n  let errorToast = false;\n\n  $: smlVersion = queryStore({\n    query: GetSmlVersionAdminDocument,\n    client,\n    variables: { smlVersionID: smlVersionId }\n  });\n\n  const onSubmit = (smlVersionData: SMLVersionData) => {\n    client\n      .mutation(UpdateSmlVersionDocument, {\n        smlVersionID: smlVersionId,\n        smlVersion: smlVersionData\n      })\n      .toPromise()\n      .then((value) => {\n        if (value.error) {\n          console.error(value.error.message);\n          errorMessage = 'Error editing SMLVersion: ' + value.error.message;\n          errorToast = true;\n        } else {\n          // TODO Toast or something\n          goto(base + '/admin/sml-versions');\n        }\n      });\n  };\n\n  $: if (!errorToast) {\n    errorMessage = '';\n  }\n\n  $: initialValues = $smlVersion.data\n    ? ({\n        ...$smlVersion.data.getSMLVersion,\n        logo: undefined\n      } as unknown as SMLVersionData)\n    : undefined;\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Edit SML Version\" title=\"Admin: Edit SML Version\" />\n</svelte:head>\n\n<h1 class=\"text-4xl my-4 font-bold\">Edit SMLVersion</h1>\n\n<Card>\n  <Content>\n    {#if $smlVersion.fetching}\n      <p>Loading...</p>\n    {:else if $smlVersion.error}\n      <p>Oh no... {$smlVersion.error.message}</p>\n    {:else}\n      <SMLVersionForm {onSubmit} {initialValues} submitText=\"Save\" />\n    {/if}\n  </Content>\n</Card>\n\n<Toast bind:running={errorToast}>\n  <span>{errorMessage}</span>\n</Toast>\n"],"names":["load","async","params","ctx","error","message","insert_hydration","target","p","anchor","set_data","t1","t1_value","fetching","span","h1","data","$$props","client","getContextClient","errorMessage","errorToast","onSubmit","smlVersionData","mutation","UpdateSmlVersionDocument","smlVersionID","smlVersionId","smlVersion","toPromise","then","value","console","$$invalidate","goto","base","$$subscribe_smlVersion","queryStore","query","GetSmlVersionAdminDocument","variables","initialValues","$smlVersion","getSMLVersion","logo","undefined"],"mappings":"ghBAEO,MAAMA,GAAiBC,MAASC,CAAAA,OAAAA,CAAAA,KAAc,CAChDA,GAAAA,CAAAA,qbCkEcC,EAAW,CAACC,EAAAA,MAAMC,QAAO,6BAAnC,WAAA,8CAAA,2CAAHC,EAA0CC,EAAAC,EAAAC,CAAAA,oCAA7BN,EAAW,CAAA,EAACC,MAAMC,QAAO,KAAAK,EAAAC,EAAAC,0EAFnC,YAAA,uCAAA,YAAA,uBAAHN,EAAgBC,EAAAC,EAAAC,yGADb,OAAAN,KAAYU,SAAQ,EAEfV,GAAYC,EAAAA,MAAK,ypBAStBD,EAAY,CAAA,CAAA,0CAAZA,EAAY,CAAA,CAAA,uBAAnBG,EAA0BC,EAAAO,EAAAL,2BAAnBN,EAAY,oRADAA,EAAU,CAAA,IAAA,mBAAVA,EAAU,+FAdK,iBAAA,uLAAA,gLAApCG,EAAAA,EAAuDC,EAAAQ,EAAAN,8LAclCN,EAAU,CAAA,4UAhElBa,CAAcC,EAAAA,EAInB,MAAAC,EAASC,EAEX,EAAA,IAAAC,EAAe,GACfC,EAAa,GAQX,MAAAC,EAAYC,IAChBL,EACGM,SAASC,GAAwB,CAChCC,aAAcC,EACdC,WAAYL,CAEbM,CAAAA,EAAAA,UAAAA,EACAC,KAAMC,GAAAA,CACDA,EAAM3B,OACR4B,QAAQ5B,MAAM2B,EAAM3B,MAAMC,OAC1B4B,EAAAA,EAAA,EAAAb,EAAe,6BAA+BW,EAAM3B,MAAMC,OAC1D4B,EAAAA,EAAA,EAAAZ,EAAa,KAGba,EAAKC,EAAO,uCAmCDd,CAAAA,EAAUU,uFA9D5BE,EAAA,GAAKN,aAAiBX,CAAAA,EAAAA,EAAIW,mBAO1BS,EAAAH,EAAA,EAAEL,EAAaS,EAAU,CACxBC,MAAOC,EACPrB,SACAsB,UAAS,CAAId,aAAcC,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,iBAsBrBN,GACNY,EAAA,EAAAb,EAAe,EAAA,iBAGda,EAAA,EAAAQ,EAAgBC,EAAY1B,MAEtB0B,GAAAA,EAAY1B,KAAK2B,cACpBC,KAAMC,MAAAA,EAERA"}