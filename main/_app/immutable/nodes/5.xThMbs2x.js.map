{"version":3,"file":"5.xThMbs2x.js","sources":["../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.ts","../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\n\nexport const load: PageLoad = async ({ params }) => ({\n  ...params\n});\n","<script lang=\"ts\">\n  import { getContextClient, queryStore } from '@urql/svelte';\n  import { GetSmlVersionAdminDocument, UpdateSmlVersionDocument } from '$lib/generated';\n  import { goto } from '$app/navigation';\n  import type { SMLVersionData } from '$lib/models/sml-versions';\n  import SMLVersionForm from '$lib/components/sml-versions/SMLVersionForm.svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import type { PageData } from './$types';\n  import { getToastStore } from '@skeletonlabs/skeleton';\n\n  export let data: PageData;\n\n  $: ({ smlVersionId } = data);\n\n  const client = getContextClient();\n\n  const toastStore = getToastStore();\n\n  $: smlVersion = queryStore({\n    query: GetSmlVersionAdminDocument,\n    client,\n    variables: { smlVersionID: smlVersionId }\n  });\n\n  const onSubmit = (smlVersionData: SMLVersionData) => {\n    client\n      .mutation(UpdateSmlVersionDocument, {\n        smlVersionID: smlVersionId,\n        smlVersion: smlVersionData\n      })\n      .toPromise()\n      .then((value) => {\n        if (value.error) {\n          console.error(value.error.message);\n          toastStore.trigger({\n            message: 'Error editing SMLVersion: ' + value.error.message,\n            background: 'variant-filled-error',\n            autohide: false\n          });\n        } else {\n          toastStore.trigger({\n            message: `SML version updated`,\n            background: 'variant-filled-success',\n            timeout: 5000\n          });\n          goto(base + '/admin/sml-versions');\n        }\n      });\n  };\n\n  $: initialValues = $smlVersion.data\n    ? ({\n        ...$smlVersion.data.getSMLVersion,\n        logo: undefined\n      } as unknown as SMLVersionData)\n    : undefined;\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Edit SML Version\" title=\"Admin: Edit SML Version\" />\n</svelte:head>\n\n<h1 class=\"my-4 text-4xl font-bold\">Edit SMLVersion</h1>\n\n<div class=\"card p-4\">\n  <section>\n    {#if $smlVersion.fetching}\n      <p>Loading...</p>\n    {:else if $smlVersion.error}\n      <p>Oh no... {$smlVersion.error.message}</p>\n    {:else}\n      <SMLVersionForm {onSubmit} {initialValues} submitText=\"Save\" />\n    {/if}\n  </section>\n</div>\n"],"names":["load","async","params","e","ctx","error","message","insert_hydration","target","p","anchor","set_data","t1","t1_value","fetching","h1","div","append_hydration","section","data","$$props","client","getContextClient","toastStore","getToastStore","onSubmit","smlVersionData","mutation","UpdateSmlVersionDocument","smlVersionID","smlVersionId","smlVersion","toPromise","then","value","console","trigger","background","autohide","timeout","goto","base","$$invalidate","$$subscribe_smlVersion","queryStore","query","GetSmlVersionAdminDocument","variables","initialValues","$smlVersion","getSMLVersion","logo","undefined"],"mappings":"sbAEO,MAAMA,GAAiBC,MAAAA,CAASC,OAAcC,CAAA,KAAA,CAAA,GAChDD,qbCmEcE,EAAW,CAAA,EAACC,MAAMC,QAAO,6BAAnC,yDAAA,WAAA,+BAAHC,CAAAA,EAA0CC,EAAAC,EAAAC,qCAA7BN,EAAW,CAAA,EAACC,MAAMC,QAAO,KAAAK,EAAAC,EAAAC,2LAFtCN,EAAgBC,EAAAC,EAAAC,CAAAA,gNADb,CAAA,OAAAN,GAAYU,EAAAA,SAAQ,EAEfV,KAAYC,MAAK,8gBAN/BE,EAAAA,EAAuDC,EAAAO,EAAAL,YAEvDH,EAUKC,EAAAQ,EAAAN,GATHO,EAQSD,EAAAE,yYA/DEC,CAAcC,EAAAA,EAInB,MAAAC,EAASC,EAET,EAAAC,EAAaC,EAQb,EAAAC,EAAYC,GAAAA,CAChBL,EACGM,SAASC,EAAwB,CAChCC,aAAcC,EACdC,WAAYL,CAEbM,CAAAA,EAAAA,UAAAA,EACAC,KAAMC,GACD,CAAAA,EAAM7B,OACR8B,QAAQ9B,MAAM6B,EAAM7B,MAAMC,OAAAA,EAC1BiB,EAAWa,QAAO,CAChB9B,QAAS,6BAA+B4B,EAAM7B,MAAMC,QACpD+B,WAAY,uBACZC,SAAU,EAAA,CAAA,IAGZf,EAAWa,QAAO,CAChB9B,QAAO,sBACP+B,WAAY,yBACZE,QAAS,MAEXC,EAAKC,EAAO,yGAjCnBC,EAAA,EAAKZ,CAAAA,aAAAA,CAAAA,EAAiBX,EAAIW,CAAAA,iBAM1Ba,EAAAD,EAAA,EAAEX,EAAaa,EAAU,CACxBC,MAAOC,EACPzB,OACA0B,EAAAA,UAAS,CAAIlB,aAAcC,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,gBA6B1BY,EAAA,EAAAM,EAAgBC,EAAY9B,MAEtB8B,GAAAA,EAAY9B,KAAK+B,cACpBC,KAAMC,MAERA,EAAAA,MAAAA"}