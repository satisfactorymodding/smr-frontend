{"version":3,"file":"index.svelte-39c7dec9.js","sources":["../../../../../../src/routes/sml-versions/index.svelte"],"sourcesContent":["<svelte:head>\n  <title>SML Versions - SMR</title>\n</svelte:head>\n\n<script lang=\"ts\">\n  import {GetSmlVersionsDocument} from \"$lib/generated\";\n  import {operationStore, query} from \"@urql/svelte\";\n  import {writable} from \"svelte/store\";\n  import PageControls from \"$lib/components/utils/PageControls.svelte\";\n  import {markdown} from '$lib/utils/markdown';\n\n  let expandedVersions = new Set<string>();\n\n  // TODO Selectable\n  const perPage = 20;\n\n  // TODO Pagination\n  const versions = operationStore(\n    GetSmlVersionsDocument,\n    {offset: 0, limit: perPage}\n  );\n\n  const page = writable(1);\n  let totalVersions: number;\n\n  page.subscribe(p => $versions.variables.offset = (p - 1) * perPage);\n\n  $: totalVersions = $versions?.data?.getSMLVersions?.count;\n\n  query(versions);\n\n  const toggleRow = (versionId: string) => {\n    if (expandedVersions.has(versionId)) {\n      expandedVersions.delete(versionId);\n    } else {\n      expandedVersions.add(versionId);\n    }\n    expandedVersions = expandedVersions;\n  }\n</script>\n\n{#if totalVersions}\n  <div class=\"mt-5 ml-auto flex justify-end\">\n    <PageControls totalPages={Math.ceil(totalVersions / perPage)} currentPage={page}/>\n  </div>\n{/if}\n\n{#if $versions.fetching}\n  <p>Loading...</p>\n{:else if $versions.error}\n  <p>Oh no... {$versions.error.message}</p>\n{:else}\n  <div class=\"grid grid-cols-6 versions\">\n    <!-- Header -->\n    <div>Version</div>\n    <div>Stability</div>\n    <div>Game Version</div>\n    <div>Release Date</div>\n    <div><!-- Buttons --></div>\n\n    {#each $versions.data.getSMLVersions.sml_versions as version}\n      <div class=\"contents version-header\" on:click={() => toggleRow(version.id)}>\n        <div>{version.version}</div>\n        <div>{version.stability}</div>\n        <div>{version.satisfactory_version}</div>\n        <!-- TODO Pretty Date -->\n        <div>{version.date}</div>\n        <div class=\"grid grid-flow-col gap-4\">\n          <a href={version.link} class=\"py-1 px-4 rounded text-base bg-blue-500 text-center\">View</a>\n        </div>\n      </div>\n\n      {#if expandedVersions.has(version.id)}\n        <div class=\"col-span-5 p-2 markdown-content\">\n          {#await markdown(version.changelog) then changelogRendered}\n            { @html changelogRendered }\n          {/await}\n        </div>\n      {/if}\n    {/each}\n  </div>\n{/if}\n\n{#if totalVersions}\n  <div class=\"mt-5 ml-auto flex justify-end\">\n    <PageControls totalPages={Math.ceil(totalVersions / perPage)} currentPage={page}/>\n  </div>\n{/if}\n\n<style lang=\"postcss\">\n  .versions {\n    grid-template-columns: auto auto auto max-content auto;\n\n    & .version-header {\n      & > div {\n        @apply border-t-2 border-white p-4;\n      }\n\n      &:hover > div {\n        @apply cursor-pointer;\n        background: rgba(255, 255, 255, 0.25);\n      }\n    }\n  }\n</style>\n"],"names":["Math","ceil","ctx","perPage","ctx2","data","getSMLVersions","sml_versions","length","error","message","markdown","changelog","version","stability","satisfactory_version","date","has","id","link","fetching","_a","_b","expandedVersions","Set","versions","operationStore","GetSmlVersionsDocument","offset","limit","page","writable","totalVersions","subscribe","$versions","variables","toggleRow","versionId","delete","add","count"],"mappings":"kkBA2C8BA,KAAKC,KAAKC,KAAgBC,eAAuBD,8PAAjDF,KAAKC,KAAKG,KAAgBD,sJAiB7CD,KAAUG,KAAKC,eAAeC,kCAAnCC,kEANG,gCACA,kCACA,qCACA,+JAHA,gEACA,kEACA,qEACA,+XAGEJ,KAAUC,KAAKC,eAAeC,qBAAnCC,6HAAAA,yDAVSN,KAAUO,MAAMC,mCAA1B,yDAAA,sFAAUN,KAAUK,MAAMC,kFAF1B,mDAAA,0LA0BaC,EAAST,KAAQU,4SAAjBD,EAAST,KAAQU,gJACfV,kIAAAE,mJAbNF,KAAQW,aACRX,KAAQY,eACRZ,KAAQa,0BAERb,KAAQc,UAMXd,KAAiBe,IAAIf,KAAQgB,+LAJqD,iaAAA,yNAA1EhB,KAAQiB,iYANbjB,KAAQW,gCACRX,KAAQY,kCACRZ,KAAQa,6CAERb,KAAQc,6BAEHd,KAAQiB,6BAIhBjB,KAAiBe,IAAIf,KAAQgB,qLAaVlB,KAAKC,KAAKC,KAAgBC,eAAuBD,8PAAjDF,KAAKC,KAAKG,KAAgBD,kIA5CnDD,kCAMAE,KAAUgB,WAELhB,KAAUK,8BAkCfP,qVA1CAE,qLA0CAA,qOArEGD,EAAU,+BAVDkB,EAAAC,MAOXC,MAAuBC,UAMrBC,EAAWC,EACfC,GACCC,OAAQ,EAAGC,MAAO1B,+BAGf2B,EAAOC,EAAS,OAClBC,IAECC,kBAAeC,EAAUC,UAAUP,UAAc,GAAKzB,SAIrDsB,SAEAW,MACAb,EAAiBN,IAAIoB,KACNC,OAAOD,KAEPE,IAAIF,uDARtBL,EAA+C,WAA/BV,EAAe,WAAfD,EAAAa,MAAAA,SAAAA,EAAW7B,gBAAIgB,SAAAA,EAAEf,0BAAcgB,SAAAA,EAAEkB,4BAkCKJ,EAAUvB,EAAQK"}