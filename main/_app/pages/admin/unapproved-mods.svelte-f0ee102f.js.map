{"version":3,"file":"unapproved-mods.svelte-f0ee102f.js","sources":["../../../../../../src/routes/admin/unapproved-mods.svelte"],"sourcesContent":["<svelte:head>\n  <title>Admin: Unapproved Mods - SMR</title>\n</svelte:head>\n\n<script lang=\"ts\">\n  import {ApproveModDocument, DenyModDocument, GetUnapprovedModsDocument} from \"$lib/generated\";\n  import {mutation, operationStore, query} from \"@urql/svelte\";\n  import {writable} from \"svelte/store\";\n  import PageControls from \"$lib/components/utils/PageControls.svelte\";\n  import {base} from \"$app/paths\";\n\n  // TODO Selectable\n  const perPage = 20;\n\n  const mods = operationStore(\n    GetUnapprovedModsDocument,\n    {\n      filter: {\n        offset: 0,\n        limit: perPage\n      }\n    }\n  );\n\n  const page = writable(1);\n  let totalMods: number;\n\n  page.subscribe(p => $mods.variables.filter.offset = (p - 1) * perPage);\n\n  $: totalMods = $mods?.data?.getUnapprovedMods?.count;\n\n  const approveModMut = mutation({\n    query: ApproveModDocument\n  });\n\n  const approveMod = (modId: string) => {\n    approveModMut({modId}).then(() => {\n      mods.reexecute();\n    });\n  }\n\n  const denyModMut = mutation({\n    query: DenyModDocument\n  });\n\n  const denyMod = (modId: string) => {\n    denyModMut({modId}).then(() => {\n      mods.reexecute();\n    });\n  }\n\n  query(mods);\n</script>\n\n{#if totalMods}\n  <div class=\"mt-5 ml-auto flex justify-end\">\n    <PageControls totalPages={Math.ceil(totalMods / perPage)} currentPage={page}/>\n  </div>\n{/if}\n\n{#if $mods.fetching}\n  <p>Loading...</p>\n{:else if $mods.error}\n  <p>Oh no... {$mods.error.message}</p>\n{:else}\n  <div class=\"grid grid-cols-6 itemList\">\n    <!-- Header -->\n    <div>Mod</div>\n    <div>Description</div>\n    <div>Release Date</div>\n    <div><!-- Buttons --></div>\n\n    {#each $mods.data.getUnapprovedMods.mods as mod}\n      <div class=\"contents itemHeader\">\n        <div>{mod.name}</div>\n        <div>{mod.short_description}</div>\n        <!-- TODO Pretty Date -->\n        <div>{mod.created_at}</div>\n        <div class=\"grid grid-flow-col gap-4\">\n          <button class=\"py-1 px-4 rounded text-base bg-green-600 text-center cursor-pointer\"\n                  on:click={() => approveMod(mod.id)}>\n            Approve\n          </button>\n          <button class=\"py-1 px-4 rounded text-base bg-red-600 text-center cursor-pointer\"\n                  on:click={() => denyMod(mod.id)}>\n            Deny\n          </button>\n          <a href={base +'/mod/' + mod.id} class=\"py-1 px-4 rounded text-base bg-blue-500 text-center cursor-pointer\">View</a>\n        </div>\n      </div>\n    {/each}\n  </div>\n{/if}\n\n{#if totalMods}\n  <div class=\"mt-5 ml-auto flex justify-end\">\n    <PageControls totalPages={Math.ceil(totalMods / perPage)} currentPage={page}/>\n  </div>\n{/if}\n\n<style lang=\"postcss\">\n  .itemList {\n    grid-template-columns: auto auto max-content auto;\n\n    & .itemHeader {\n      & > div {\n        @apply border-t-2 border-white p-4;\n      }\n\n      &:hover > div {\n        background: rgba(255, 255, 255, 0.25);\n      }\n    }\n  }\n</style>\n"],"names":["Math","ceil","ctx","perPage","ctx2","data","getUnapprovedMods","mods","length","error","message","name","short_description","created_at","base","id","fetching","_a","_b","operationStore","GetUnapprovedModsDocument","filter","offset","limit","page","writable","totalMods","subscribe","$mods","variables","approveModMut","mutation","query","ApproveModDocument","approveMod","modId","then","reexecute","denyModMut","DenyModDocument","denyMod","count","mod"],"mappings":"ikBAwD8BA,KAAKC,KAAKC,KAAYC,eAAuBD,8PAA7CF,KAAKC,KAAKG,KAAYD,gJAgBzCD,KAAMG,KAAKC,kBAAkBC,0BAAlCC,kEALG,4BACA,oCACA,+JAFA,4DACA,oEACA,yWAGEJ,KAAMC,KAAKC,kBAAkBC,aAAlCC,6HAAAA,yDATSN,KAAMO,MAAMC,mCAAtB,yDAAA,sFAAUN,KAAMK,MAAMC,kFAFtB,mDAAA,yIAaSR,MAAIS,UACJT,MAAIU,uBAEJV,MAAIW,yMAGmC,mCAIH,2BAGoE,+UAPjE,2EAIH,2EAGoE,4UAAnGC,EAAM,QAAUZ,MAAIa,uZAbzBb,MAAIS,6BACJT,MAAIU,0CAEJV,MAAIW,mCAUCC,EAAM,QAAUZ,MAAIa,uGASTf,KAAKC,KAAKC,KAAYC,eAAuBD,8PAA7CF,KAAKC,KAAKG,KAAYD,kIA1C/CD,kCAMAE,KAAMY,WAEDZ,KAAMK,8BAgCXP,+VAxCAE,qLAwCAA,qOAlFGD,EAAU,+BARDc,EAAAC,QAUTX,EAAOY,EACXC,GAEEC,QACEC,OAAQ,EACRC,MAAOpB,gCAKPqB,EAAOC,EAAS,OAClBC,IAECC,kBAAeC,EAAMC,UAAUR,OAAOC,UAAc,GAAKnB,aAIxD2B,EAAgBC,GACpBC,MAAOC,IAGHC,SACWC,MAAAA,IAAQC,aAChBC,gBAIHC,EAAaP,GACjBC,MAAOO,IAGHC,SACQL,MAAAA,IAAQC,aACbC,kBAIH9B,+CAtBHmB,EAA0C,WAA9BR,EAAW,WAAXD,EAAAW,MAAAA,SAAAA,EAAOvB,gBAAIY,SAAAA,EAAEX,6BAAiBY,SAAAA,EAAEuB,4BAmDfP,EAAWQ,EAAI3B,OAIfyB,EAAQE,EAAI3B"}