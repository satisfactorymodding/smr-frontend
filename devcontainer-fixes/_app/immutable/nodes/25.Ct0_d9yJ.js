import{S as Se,i as ke,d as A,s as Ee,H as we,I as Ce,v as Pe,J as ne,F as re,ac as oe,a1 as ie,M as Ie,P as G,b as B,e as x,a4 as Ve,Q as W,j as g,k as D,g as b,R as O,h as I,N as p,m as y,T as X,n as j,U as d,t as z,q as Ne,r as L,W as Y,u as H,x as Ue,p as Be,$ as le,V as De,ad as je,a0 as Me,X as pe,Y as ge,Z as $e}from"../chunks/vendor.CBHNzP-N.js";import{k as ce}from"../chunks/graphql.BdWB12cY.js";import{o as Re,a as Te,b as Ae,s as Oe,c as ue,v as fe,r as me,V as Z,z as ze}from"../chunks/forms.BIeRJMfk.js";import{t as de}from"../chunks/forms.DnLe5FAZ.js";import{u as Q}from"../chunks/user.DIFL2fYc.js";import{M as he}from"../chunks/MetaDescriptors.DwfzqnSg.js";const{console:Le}=Ie,S="src/routes/settings/+page.svelte";function ve(l){let e,s,a,i,o="Avatar:",r,n,$,c,C,h,u,m,M="Username",E,t,v,f,R,T,V,ee="Save",_,J,te;c=new Z({props:{for:"avatar",$$slots:{default:[be,({messages:w})=>({8:w}),({messages:w})=>w?256:0]},$$scope:{ctx:l}},$$inline:!0}),f=new Z({props:{for:"username",$$slots:{default:[ye,({messages:w})=>({8:w}),({messages:w})=>w?256:0]},$$scope:{ctx:l}},$$inline:!0});const ae={c:function(){e=x("form"),s=x("div"),a=x("div"),i=x("label"),i.textContent=o,r=B(),n=x("input"),$=B(),G(c.$$.fragment),C=B(),h=x("div"),u=x("label"),m=x("span"),m.textContent=M,E=B(),t=x("input"),v=B(),G(f.$$.fragment),R=B(),T=x("div"),V=x("button"),V.textContent=ee,this.h()},l:function(k){e=b(k,"FORM",{});var P=I(e);s=b(P,"DIV",{class:!0});var N=I(s);a=b(N,"DIV",{class:!0});var U=I(a);i=b(U,"LABEL",{for:!0,"data-svelte-h":!0}),O(i)!=="svelte-1a2u3bg"&&(i.textContent=o),r=D(U),n=b(U,"INPUT",{id:!0,class:!0,name:!0,type:!0,accept:!0,placeholder:!0}),$=D(U),W(c.$$.fragment,U),U.forEach(g),C=D(N),h=b(N,"DIV",{class:!0});var q=I(h);u=b(q,"LABEL",{class:!0});var F=I(u);m=b(F,"SPAN",{"data-svelte-h":!0}),O(m)!=="svelte-9difb2"&&(m.textContent=M),E=D(F),t=b(F,"INPUT",{type:!0,class:!0}),F.forEach(g),v=D(q),W(f.$$.fragment,q),q.forEach(g),R=D(N),T=b(N,"DIV",{});var se=I(T);V=b(se,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),O(V)!=="svelte-13mhoq1"&&(V.textContent=ee),se.forEach(g),N.forEach(g),P.forEach(g),this.h()},h:function(){p(i,"for","avatar"),y(i,S,83,12,2729),p(n,"id","avatar"),p(n,"class","base-input"),p(n,"name","avatar"),p(n,"type","file"),p(n,"accept","image/png,image/jpeg,image/gif"),p(n,"placeholder","Avatar"),y(n,S,84,12,2777),p(a,"class","grid grid-flow-row gap-2"),y(a,S,82,10,2678),y(m,S,98,14,3275),p(t,"type","text"),t.required=!0,p(t,"class","input p-2"),y(t,S,99,14,3311),p(u,"class","label"),y(u,S,97,12,3239),p(h,"class","grid grid-flow-row gap-2"),y(h,S,96,10,3188),p(V,"class","variant-ghost-primary btn"),p(V,"type","submit"),y(V,S,107,12,3628),y(T,S,106,10,3610),p(s,"class","grid grid-flow-row gap-6"),y(s,S,81,8,2629),y(e,S,80,6,2605)},m:function(k,P){j(k,e,P),d(e,s),d(s,a),d(a,i),d(a,r),d(a,n),d(a,$),X(c,a,null),d(s,C),d(s,h),d(h,u),d(u,m),d(u,E),d(u,t),le(t,l[3].username),d(h,v),X(f,h,null),d(s,R),d(s,T),d(T,V),_=!0,J||(te=[De(t,"input",l[5]),je(l[2].call(null,e))],J=!0)},p:function(k,P){const N={};P&768&&(N.$$scope={dirty:P,ctx:k}),c.$set(N),P&8&&t.value!==k[3].username&&le(t,k[3].username);const U={};P&768&&(U.$$scope={dirty:P,ctx:k}),f.$set(U)},i:function(k){_||(L(c.$$.fragment,k),L(f.$$.fragment,k),_=!0)},o:function(k){z(c.$$.fragment,k),z(f.$$.fragment,k),_=!1},d:function(k){k&&g(e),Y(c),Y(f),J=!1,Me(te)}};return A("SvelteRegisterBlock",{block:ae,id:ve.name,type:"else",source:"(72:4) {:else}",ctx:l}),ae}function xe(l){let e,s="Please log in";const a={c:function(){e=x("p"),e.textContent=s,this.h()},l:function(o){e=b(o,"P",{"data-svelte-h":!0}),O(e)!=="svelte-1njyisr"&&(e.textContent=s),this.h()},h:function(){y(e,S,78,6,2566)},m:function(o,r){j(o,e,r)},p:H,i:H,o:H,d:function(o){o&&g(e)}};return A("SvelteRegisterBlock",{block:a,id:xe.name,type:"if",source:"(70:4) {#if $user === null}",ctx:l}),a}function be(l){let e,s=(l[8]||"")+"",a;const i={c:function(){e=x("span"),a=pe(s),this.h()},l:function(r){e=b(r,"SPAN",{class:!0});var n=I(e);a=ge(n,s),n.forEach(g),this.h()},h:function(){p(e,"class","validation-message"),y(e,S,92,14,3071)},m:function(r,n){j(r,e,n),d(e,a)},p:function(r,n){n&256&&s!==(s=(r[8]||"")+"")&&$e(a,s)},d:function(r){r&&g(e)}};return A("SvelteRegisterBlock",{block:i,id:be.name,type:"slot",source:'(84:12) <ValidationMessage for=\\"avatar\\" let:messages={message}>',ctx:l}),i}function ye(l){let e,s=(l[8]||"")+"",a;const i={c:function(){e=x("span"),a=pe(s),this.h()},l:function(r){e=b(r,"SPAN",{class:!0});var n=I(e);a=ge(n,s),n.forEach(g),this.h()},h:function(){p(e,"class","validation-message"),y(e,S,102,14,3493)},m:function(r,n){j(r,e,n),d(e,a)},p:function(r,n){n&256&&s!==(s=(r[8]||"")+"")&&$e(a,s)},d:function(r){r&&g(e)}};return A("SvelteRegisterBlock",{block:i,id:ye.name,type:"slot",source:'(94:12) <ValidationMessage for=\\"username\\" let:messages={message}>',ctx:l}),i}function K(l){let e,s,a,i="Settings",o,r,n,$,c,C;e=new he({props:{description:"Change your user settings",title:"Settings"},$$inline:!0});const h=[xe,ve],u=[];function m(E,t){return E[1]===null?0:1}$=m(l),c=u[$]=h[$](l);const M={c:function(){G(e.$$.fragment),s=B(),a=x("h1"),a.textContent=i,o=B(),r=x("div"),n=x("section"),c.c(),this.h()},l:function(t){const v=Ve("svelte-1ae5i2c",document.head);W(e.$$.fragment,v),v.forEach(g),s=D(t),a=b(t,"H1",{class:!0,"data-svelte-h":!0}),O(a)!=="svelte-1pzybri"&&(a.textContent=i),o=D(t),r=b(t,"DIV",{class:!0});var f=I(r);n=b(f,"SECTION",{});var R=I(n);c.l(R),R.forEach(g),f.forEach(g),this.h()},h:function(){p(a,"class","my-4 text-4xl font-bold"),y(a,S,73,0,2449),y(n,S,76,2,2525),p(r,"class","card p-4"),y(r,S,75,0,2500)},m:function(t,v){X(e,document.head,null),j(t,s,v),j(t,a,v),j(t,o,v),j(t,r,v),d(r,n),u[$].m(n,null),C=!0},p:function(t,[v]){let f=$;$=m(t),$===f?u[$].p(t,v):(Be(),z(u[f],1,1,()=>{u[f]=null}),Ne(),c=u[$],c?c.p(t,v):(c=u[$]=h[$](t),c.c()),L(c,1),c.m(n,null))},i:function(t){C||(L(e.$$.fragment,t),L(c),C=!0)},o:function(t){z(e.$$.fragment,t),z(c),C=!1},d:function(t){t&&(g(s),g(a),g(o),g(r)),Y(e),u[$].d()}};return A("SvelteRegisterBlock",{block:M,id:K.name,type:"component",source:"",ctx:l}),M}function _e(l,e,s){let a,i,o=H,r=()=>(o(),o=Ue(m,t=>s(3,i=t)),m);we(Q,"user"),Ce(l,Q,t=>s(1,a=t)),l.$$.on_destroy.push(()=>o());let{$$slots:n={},$$scope:$}=e;Pe("Page",n,[]);const c=ne(),C=re(),h=Re({avatar:Te(Ae().refine(t=>"name"in t&&"size"in t&&"type"in t)),username:Oe().min(3).max(32)});let u,m;const M=[];Object.keys(e).forEach(t=>{!~M.indexOf(t)&&t.slice(0,2)!=="$$"&&t!=="slot"&&Le.warn(`<Page> was created with unknown prop '${t}'`)});function E(){i.username=this.value,m.set(i)}return l.$capture_state=()=>({getContextClient:re,UpdateUserDocument:ce,goto:oe,createForm:ue,validator:fe,reporter:me,ValidationMessage:Z,trimNonSchema:de,user:Q,zod:ze,base:ie,MetaDescriptors:he,getToastStore:ne,toastStore:c,client:C,userSchema:h,form:u,data:m,$user:a,$data:i}),l.$inject_state=t=>{"form"in t&&s(2,u=t.form),"data"in t&&r(s(0,m=t.data))},e&&"$$inject"in e&&l.$inject_state(e.$$inject),l.$$.update=()=>{if(l.$$.dirty&3&&a&&!m){const t=ue({initialValues:{username:a.username},extend:[fe({schema:h}),me],onSubmit:v=>{console.log("submitted",v),C.mutation(ce,{user:de(v,h),userId:a.id}).toPromise().then(f=>{f.error?(console.error(f.error.message),c.trigger({message:"Error editing user: "+f.error.message,background:"variant-filled-error",autohide:!1})):(c.trigger({message:"User updated",background:"variant-filled-success",timeout:5e3}),oe(ie+"/user/"+f.data.updateUser.id))})}});s(2,u=t.form),r(s(0,m=t.data))}},[m,a,u,i,h,E]}class We extends Se{constructor(e){super(e),ke(this,e,_e,K,Ee,{userSchema:4}),A("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:K.name})}get userSchema(){return this.$$.ctx[4]}set userSchema(e){throw new Error("<Page>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}export{We as component};
//# sourceMappingURL=25.Ct0_d9yJ.js.map
