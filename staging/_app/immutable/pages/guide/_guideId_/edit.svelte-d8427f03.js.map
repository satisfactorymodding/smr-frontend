{"version":3,"file":"edit.svelte-d8427f03.js","sources":["../../../../../../../../src/routes/guide/[guideId]/edit.svelte"],"sourcesContent":["<script lang=\"ts\" context=\"module\">\n  import { paramsToProps } from '$lib/utils/routing';\n  import Card, { Content } from '@smui/card';\n\n  export const load = paramsToProps();\n</script>\n\n<script lang=\"ts\">\n  import { mutation, operationStore, query } from '@urql/svelte';\n  import { EditGuideDocument, GetGuideDocument } from '$lib/generated';\n  import Toast from '$lib/components/general/Toast.svelte';\n  import { goto } from '$app/navigation';\n  import GuideForm from '$lib/components/guides/GuideForm.svelte';\n  import type { GuideData } from '$lib/models/guides';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n\n  export let guideId!: string;\n\n  let errorMessage = '';\n  let errorToast = false;\n\n  const guide = operationStore(GetGuideDocument, { guide: guideId });\n\n  const editGuide = mutation({\n    query: EditGuideDocument\n  });\n\n  const onSubmit = (data: GuideData) => {\n    editGuide({\n      guideId: guideId,\n      guide: data\n    }).then((value) => {\n      if (value.error) {\n        console.error(value.error.message);\n        errorMessage = 'Error editing guide: ' + value.error.message;\n        errorToast = true;\n      } else {\n        // TODO Toast or something\n        goto(base + '/guide/' + value.data.updateGuide.id);\n      }\n    });\n  };\n\n  $: if (!errorToast) {\n    errorMessage = '';\n  }\n\n  query(guide);\n</script>\n\n<svelte:head>\n  {#if !$guide.fetching && !$guide.error && $guide.data.getGuide}\n    <MetaDescriptors\n      description=\"Editing guide '{$guide.data.getGuide.short_description}'\"\n      title=\"Edit guide '{$guide.data.getGuide.name}'\" />\n  {/if}\n</svelte:head>\n\n<h1 class=\"text-4xl my-4 font-bold\">Edit Guide</h1>\n\n<Card>\n  <Content>\n    {#if $guide.fetching}\n      <p>Loading...</p>\n    {:else if $guide.error}\n      <p>Oh no... {$guide.error.message}</p>\n    {:else}\n      <GuideForm {onSubmit} initialValues={$guide.data.getGuide} submitText=\"Save\" />\n    {/if}\n  </Content>\n</Card>\n\n<Toast bind:running={errorToast}>\n  <span>{errorMessage}</span>\n</Toast>\n"],"names":["description","ctx","data","getGuide","short_description","title","name","dirty","metadescriptors_changes","error","message","insert_hydration","target","p","anchor","set_data","t1","t1_value","fetching","span","create_if_block_2","h1","load","paramsToProps","guideId","$$props","errorMessage","errorToast","guide","operationStore","GetGuideDocument","editGuide","mutation","query","EditGuideDocument","onSubmit","then","value","console","$$invalidate","goto","base","updateGuide","id"],"mappings":"wgCAsDmCA,YAAA,kBAAAC,EAAO,GAAAC,KAAKC,SAASC,kBAAiB,IAC/CC,MAAA,eAAAJ,EAAO,GAAAC,KAAKC,SAASG,KAAI,+FADhB,AAAAC,EAAA,GAAAC,GAAAR,YAAA,kBAAAC,EAAO,GAAAC,KAAKC,SAASC,kBAAiB,KAC/CG,EAAA,GAAAC,GAAAH,MAAA,eAAAJ,EAAO,GAAAC,KAAKC,SAASG,KAAI,0KAaRL,EAAM,GAACC,KAAKC,4IAAZF,EAAM,GAACC,KAAKC,6HAFpCF,EAAM,GAACQ,MAAMC,QAAO,6BAA9B,yDAAA,0CAAHC,CAAAA,EAAqCC,EAAAC,EAAAC,qCAAxBb,EAAM,GAACQ,MAAMC,QAAO,KAAAK,EAAAC,EAAAC,0EAF9B,YAAA,CAAA,sCAAA,YAAA,sBAAHN,CAAAA,EAAgBC,EAAAC,EAAAC,CAAAA,wGADb,MAAAb,MAAOiB,SAAQ,EAEVjB,KAAOQ,MAAK,wpBASjBR,EAAY,4CAAZA,EAAY,EAAA,uBAAnBU,EAA0BC,EAAAO,EAAAL,CAAAA,0BAAnBb,EAAY,8DAtBbA,EAAM,GAACiB,UAAAA,CAAajB,EAAM,GAACQ,OAASR,EAAM,GAACC,KAAKC,UAAQiB,EAAAnB,CAAAA,uIAqB3CA,GAAU,KAAA,mBAAVA,EAAU,6FAdK,gNAAA,mMAApCU,EAAkDC,EAAAS,EAAAP,CAAAA,6DAP1Cb,EAAM,GAACiB,UAAajB,CAAAA,EAAM,GAACQ,OAASR,EAAM,GAACC,KAAKC,8OAqBnCF,EAAU,4MArEhB,CAAA,CAAA,CAAA,CAAA,KAAAqB,IAAOC,GAAAA,oCAaTC,GAAgBC,EAEvBC,EAAe,GACfC,EAAa,GAEX,KAAAC,GAAQC,EAAeC,GAAoB,CAAAF,MAAOJ,uBAElD,KAAAO,GAAYC,EAChB,CAAAC,MAAOC,EAGH,CAAA,EAAAC,EAAYjC,GAChB6B,CAAAA,EAAS,CACEP,QAAAA,EACTI,MAAO1B,CACNkC,CAAAA,EAAAA,KAAMC,GACH,CAAA,AAAAA,EAAM5B,MACR6B,SAAQ7B,MAAM4B,EAAM5B,MAAMC,OAAAA,EAC1B6B,EAAA,EAAAb,EAAe,wBAA0BW,EAAM5B,MAAMC,OAAAA,EACrD6B,EAAA,EAAAZ,EAAa,EAAA,GAGba,GAAKC,GAAO,UAAYJ,EAAMnC,KAAKwC,YAAYC,EAAAA,CAAAA,CAAAA,CAAAA,EASrDV,EAAML,CAAAA,gBAyBaD,EAAUU,4FA7BrBV,IACNY,EAAA,EAAAb,EAAe"}