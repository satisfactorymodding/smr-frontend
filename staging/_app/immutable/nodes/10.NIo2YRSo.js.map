{"version":3,"file":"10.NIo2YRSo.js","sources":["../../../../../../src/routes/guide/[guideId]/+page.ts","../../../../../../src/lib/components/guides/GuideInfo.svelte","../../../../../../src/lib/components/guides/GuideAuthor.svelte","../../../../../../src/routes/guide/[guideId]/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\nimport { queryStore } from '@urql/svelte';\nimport { GetGuideDocument } from '$lib/generated';\nimport { loadWaitForNoFetch } from '$lib/utils/gql';\n\nexport const prerender = false;\n\nexport const load: PageLoad = async ({ params, parent }) => ({\n  ...params,\n  ...(await loadWaitForNoFetch({\n    guide: queryStore({\n      query: GetGuideDocument,\n      client: (await parent()).client,\n      variables: { guide: params.guideId }\n    })\n  }))\n});\n","<script lang=\"ts\">\n  import type { Guide } from '$lib/generated';\n  import { prettyDate } from '$lib/utils/formatting';\n  import { getTranslate } from '@tolgee/svelte';\n\n  export let guide!: Pick<Guide, 'created_at'>;\n\n  export const { t } = getTranslate();\n</script>\n\n<div class=\"card p-4\">\n  <section>\n    <div class=\"text-lg\">\n      <h3 class=\"my-4 text-2xl font-bold\">{$t('entry.info')}</h3>\n      <span><strong>{$t('entry.created-at')}:</strong> {prettyDate(guide.created_at)}</span><br />\n    </div>\n  </section>\n</div>\n","<script lang=\"ts\">\n  import type { User } from '$lib/generated';\n  import { base } from '$app/paths';\n  import { getTranslate } from '@tolgee/svelte';\n\n  export let author: Pick<User, 'id' | 'username' | 'avatar'>;\n\n  export const { t } = getTranslate();\n</script>\n\n<div class=\"card p-4\">\n  <section>\n    <div class=\"grid grid-flow-row gap-y-2\">\n      <h3 class=\"my-4 text-2xl font-bold\">{$t('author')}</h3>\n\n      <div class=\"grid auto-rows-min gap-y-4 text-lg\">\n        <div class=\"grid auto-cols-min grid-flow-col gap-x-4\">\n          <div class=\"h-14 w-14 rounded-full bg-cover\" style={`background-image: url(\"${author.avatar}\")`} />\n          <div class=\"grid grid-flow-row\">\n            <a href=\"{base}/user/{author.id}/\" class=\"text-yellow-500 underline\">{author.username}</a>\n            <div>{$t('role.writer')}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </section>\n</div>\n","<script lang=\"ts\">\n  import { DeleteGuideDocument } from '$lib/generated';\n  import GuideInfo from '$lib/components/guides/GuideInfo.svelte';\n  import GuideAuthor from '$lib/components/guides/GuideAuthor.svelte';\n  import { user } from '$lib/stores/user';\n  import { goto } from '$app/navigation';\n  import { markdown } from '$lib/utils/markdown';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import { getContextClient } from '@urql/svelte';\n  import type { PageData } from './$types';\n  import { getModalStore, getToastStore, type ModalSettings } from '@skeletonlabs/skeleton';\n  import Page404 from '$lib/components/general/Page404.svelte';\n\n  export let data: PageData;\n\n  $: ({ guideId, guide } = data);\n\n  const client = getContextClient();\n\n  const toastStore = getToastStore();\n\n  $: canUserEdit = $user?.roles?.deleteContent || $user?.id === $guide?.data?.getGuide?.user?.id;\n\n  const deleteGuideFn = () => {\n    client\n      .mutation(DeleteGuideDocument, { guideId })\n      .toPromise()\n      .then((value) => {\n        if (value.error) {\n          console.error(value.error.message);\n          toastStore.trigger({\n            message: 'Error deleting guide: ' + value.error.message,\n            background: 'variant-filled-error',\n            autohide: false\n          });\n        } else {\n          toastStore.trigger({\n            message: `Guide deleted`,\n            background: 'variant-filled-success',\n            timeout: 5000\n          });\n          goto(base + '/guides');\n        }\n      });\n  };\n\n  const deleteModal: ModalSettings = {\n    type: 'confirm',\n    title: 'Delete Guide?',\n    body: 'Are you sure you wish to delete this guide?',\n    response: (r: boolean) => {\n      if (r) {\n        deleteGuideFn();\n      }\n    }\n  };\n\n  const modalStore = getModalStore();\n</script>\n\n<svelte:head>\n  {#if !$guide.fetching && !$guide.error && $guide.data.getGuide}\n    <MetaDescriptors description={$guide.data.getGuide.short_description} title={$guide.data.getGuide.name} />\n  {/if}\n</svelte:head>\n\n{#if $guide.fetching}\n  <p>Loading...</p>\n{:else if $guide.error}\n  <p>Oh no... {$guide.error.message}</p>\n{:else if $guide.data.getGuide}\n  <div class=\"grid gap-6 xlx:grid-flow-row\">\n    <div class=\"flex h-auto flex-wrap items-center justify-between\">\n      <h1 class=\"text-4xl font-bold\">{$guide.data.getGuide.name}</h1>\n\n      <div>\n        {#if canUserEdit}\n          <button class=\"variant-ghost-primary btn\" on:click={() => goto(base + '/guide/' + guideId + '/edit')}>\n            <span class=\"material-icons pr-2\">edit</span>\n            Edit</button>\n          <button class=\"variant-ghost-primary btn\" on:click={() => modalStore.trigger(deleteModal)}>\n            <span class=\"material-icons pr-2\">delete</span>\n            Delete</button>\n        {/if}\n      </div>\n    </div>\n    <div class=\"grid-auto-max grid auto-cols-fr gap-4\">\n      <div class=\"card h-fit p-4\">\n        <section>\n          <div class=\"markdown-content break-words\">\n            {#await markdown($guide.data.getGuide.guide) then guideRendered}\n              <!-- eslint-disable -->\n              <p>{@html guideRendered}</p>\n            {/await}\n          </div>\n        </section>\n      </div>\n      <div class=\"grid auto-rows-min grid-cols-1 gap-8\">\n        <GuideInfo guide={$guide.data.getGuide} />\n        <GuideAuthor author={$guide.data.getGuide.user} />\n      </div>\n    </div>\n  </div>\n{:else}\n  <Page404 />\n{/if}\n"],"names":["prerender","load","async","params","parent","loadWaitForNoFetch","guide","queryStore","query","GetGuideDocument","client","variables","guideId","t0_value","ctx","t2_value","prettyDate","created_at","insert_hydration_dev","target","div1","anchor","append_hydration_dev","section","div0","h3","span","strong","br","dirty","set_data_dev","t0","t2","t5","t5_value","$$props","t","getTranslate","t3_value","username","attr_dev","div0_style_value","avatar","base","id","div6","div5","div4","div3","div2","a","t3","author","description","data","getGuide","short_description","title","name","metadescriptors_changes","create_if_block_3","handle_promise","promise","markdown","info","user","h1","current","guideauthor_changes","error","message","p","t1","t1_value","button0","span0","button1","span1","html_tag","raw_value","fetching","create_if_block_4","getContextClient","toastStore","getToastStore","deleteGuideFn","mutation","DeleteGuideDocument","toPromise","then","value","console","trigger","background","autohide","timeout","goto","deleteModal","type","body","response","r","modalStore","getModalStore","click_handler","$$invalidate","$$subscribe_guide","canUserEdit","$user","roles","deleteContent","$guide"],"mappings":"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"}