{"version":3,"file":"7.DNyyRV6G.js","sources":["../../../../../../src/routes/admin/unapproved-mods/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { ApproveModDocument, DenyModDocument, GetUnapprovedModsDocument } from '$lib/generated';\n  import { getContextClient, queryStore } from '@urql/svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import { prettyDate } from '$lib/utils/formatting';\n  import { type PaginationSettings, Paginator } from '@skeletonlabs/skeleton';\n\n  const client = getContextClient();\n\n  let perPage = 20;\n  let page = 0;\n\n  $: mods = queryStore({\n    query: GetUnapprovedModsDocument,\n    client,\n    variables: {\n      filter: {\n        offset: page * perPage,\n        limit: perPage\n      }\n    }\n  });\n\n  $: totalMods = $mods?.data?.getUnapprovedMods?.count;\n\n  const approveMod = (modId: string) => {\n    client\n      .mutation(ApproveModDocument, { modId })\n      .toPromise()\n      .then(() => {\n        mods.pause();\n        mods.resume();\n      });\n  };\n\n  const denyMod = (modId: string) => {\n    client\n      .mutation(DenyModDocument, { modId })\n      .toPromise()\n      .then(() => {\n        mods.pause();\n        mods.resume();\n      });\n  };\n\n  $: paginationSettings = {\n    page: page,\n    limit: perPage,\n    size: totalMods,\n    amounts: [5, 10, 20, 50, 100]\n  } satisfies PaginationSettings;\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Unapproved mods\" title=\"Admin: Unapproved Mods\" />\n</svelte:head>\n\n<h1>Unapproved Mods</h1>\n\n{#if totalMods}\n  <div class=\"mb-5 ml-auto flex justify-end\">\n    <div>\n      <Paginator\n        bind:settings={paginationSettings}\n        showFirstLastButtons={true}\n        showPreviousNextButtons={true}\n        on:page={(p) => (page = p.detail)}\n        on:amount={(p) => (perPage = p.detail)}\n        controlVariant=\"variant-filled-surface\" />\n    </div>\n  </div>\n{/if}\n\n<div class=\"card\">\n  {#if $mods.fetching}\n    <section class=\"p-4\">Loading...</section>\n  {:else if $mods.error}\n    <section class=\"p-4\">Oh no... {$mods.error.message}</section>\n  {:else}\n    <table class=\"table table-hover max-w-full\">\n      <thead>\n        <tr>\n          <th>Mod</th>\n          <th>Description</th>\n          <th>Release Date</th>\n          <th><!-- Buttons --></th>\n        </tr>\n      </thead>\n      <tbody>\n        {#each $mods.data.getUnapprovedMods.mods as mod}\n          <tr>\n            <td>{mod.name}</td>\n            <td>{mod.short_description}</td>\n            <td>{prettyDate(mod.created_at)}</td>\n            <td class=\"!p-2.5\">\n              <div class=\"grid grid-flow-col gap-4\">\n                <button class=\"variant-ghost-primary btn btn-sm\" on:click={() => approveMod(mod.id)}>Approve</button>\n                <button class=\"variant-ghost-primary btn btn-sm\" on:click={() => denyMod(mod.id)}>Deny</button>\n                <a class=\"variant-ghost-primary btn btn-sm\" href={base + '/mod/' + mod.id}>View</a>\n              </div>\n            </td>\n          </tr>\n        {/each}\n      </tbody>\n    </table>\n  {/if}\n</div>\n\n{#if totalMods}\n  <div class=\"ml-auto mt-5 flex justify-end\">\n    <div>\n      <Paginator\n        bind:settings={paginationSettings}\n        showFirstLastButtons={true}\n        showPreviousNextButtons={true}\n        on:page={(p) => (page = p.detail)}\n        on:amount={(p) => (perPage = p.detail)}\n        controlVariant=\"variant-filled-surface\" />\n    </div>\n  </div>\n{/if}\n\n<style lang=\"postcss\">\n  h1 {\n    @apply my-4 text-4xl font-bold;\n  }\n</style>\n"],"names":["ctx","insert_hydration_dev","target","div1","anchor","append_hydration_dev","div0","each_value","ensure_array_like_dev","data","getUnapprovedMods","mods","length","i","table","thead","tr","th0","th1","th2","th3","tbody","error","message","section","set_data_dev","t1","t1_value","t0_value","name","t2_value","short_description","prettyDate","created_at","attr_dev","a","a_href_value","base","id","td0","td1","td2","td3","div","button0","button1","dirty","t0","t2","t4","t4_value","create_if_block_3","fetching","create_if_block_1","create_if_block_2","create_if_block","h1","client","getContextClient","perPage","page","approveMod","modId","mutation","ApproveModDocument","toPromise","then","pause","resume","denyMod","DenyModDocument","paginationSettings","value","page_handler","p","$$invalidate","detail","amount_handler","mod","page_handler_1","amount_handler_1","$$subscribe_mods","queryStore","query","GetUnapprovedModsDocument","variables","filter","offset","limit","totalMods","$mods","count","size","amounts"],"mappings":"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"}