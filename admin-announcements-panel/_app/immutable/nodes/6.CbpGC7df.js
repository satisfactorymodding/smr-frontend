import{S as It,i as Pt,d as R,s as Bt,v as Rt,_ as nt,af as at,Z as At,a8 as Et,a4 as st,ag as dt,ah as mt,a7 as Ot,e as b,b as P,g as C,J as E,k as B,h as q,j as x,K as S,m as N,n as w,t as Q,q as pt,r as j,y as it,T as ot,p as ht,G as vt,I as $t,L as xt,M as I,O as U,Q as yt,a0 as W,a1 as Z,a3 as kt,u as H,f as ct,W as jt,N as J,R as Ft}from"../chunks/vendor.PpbVXdev.js";import{g as lt,h as rt,i as ut,j as ft}from"../chunks/graphql.DWrE1hTh.js";const{console:Ut}=Ot,D="src/routes/admin/tag-manager/+page.svelte";function gt(n,t,l){const o=n.slice();return o[19]=t[l],o[20]=t,o[21]=l,o}function Tt(n){let t,l,o,e,a,u="Add new tag",c,s,r="add",f,d,p;t=new dt({props:{$$slots:{default:[St]},$$scope:{ctx:n}},$$inline:!0});const g={c:function(){vt(t.$$.fragment),l=P(),o=b("section"),e=b("button"),a=b("span"),a.textContent=u,c=P(),s=b("span"),s.textContent=r,this.h()},l:function(m){$t(t.$$.fragment,m),l=B(m),o=C(m,"SECTION",{class:!0});var $=q(o);e=C($,"BUTTON",{class:!0});var k=q(e);a=C(k,"SPAN",{"data-svelte-h":!0}),E(a)!=="svelte-haz7sd"&&(a.textContent=u),c=B(k),s=C(k,"SPAN",{class:!0,"data-svelte-h":!0}),E(s)!=="svelte-99y27o"&&(s.textContent=r),k.forEach(x),$.forEach(x),this.h()},h:function(){N(a,D,177,8,5184),S(s,"class","material-icons"),N(s,D,178,8,5217),S(e,"class","variant-ghost-primary btn"),N(e,D,176,6,5115),S(o,"class","p-4"),N(o,D,175,4,5087)},m:function(m,$){xt(t,m,$),w(m,l,$),w(m,o,$),I(o,e),I(e,a),I(e,c),I(e,s),f=!0,d||(p=U(e,"click",n[5],!1,!1,!1,!1),d=!0)},p:function(m,$){const k={};$&4194318&&(k.$$scope={dirty:$,ctx:m}),t.$set(k)},i:function(m){f||(j(t.$$.fragment,m),f=!0)},o:function(m){Q(t.$$.fragment,m),f=!1},d:function(m){m&&(x(l),x(o)),yt(t,m),d=!1,p()}};return R("SvelteRegisterBlock",{block:g,id:Tt.name,type:"else",source:"(133:2) {:else}",ctx:n}),g}function bt(n){let t,l,o=n[0].error.message+"",e;const a={c:function(){t=b("h1"),l=W("Failed to load tags: "),e=W(o),this.h()},l:function(c){t=C(c,"H1",{class:!0});var s=q(t);l=Z(s,"Failed to load tags: "),e=Z(s,o),s.forEach(x),this.h()},h:function(){S(t,"class","svelte-1egakhm"),N(t,D,141,4,3878)},m:function(c,s){w(c,t,s),I(t,l),I(t,e)},p:function(c,s){s&1&&o!==(o=c[0].error.message+"")&&kt(e,o)},i:H,o:H,d:function(c){c&&x(t)}};return R("SvelteRegisterBlock",{block:a,id:bt.name,type:"if",source:"(131:29) ",ctx:n}),a}function Ct(n){let t,l="Loading tags...";const o={c:function(){t=b("h1"),t.textContent=l,this.h()},l:function(a){t=C(a,"H1",{class:!0,"data-svelte-h":!0}),E(t)!=="svelte-ud4eq5"&&(t.textContent=l),this.h()},h:function(){S(t,"class","svelte-1egakhm"),N(t,D,139,4,3819)},m:function(a,u){w(a,t,u)},p:H,i:H,o:H,d:function(a){a&&x(t)}};return R("SvelteRegisterBlock",{block:o,id:Ct.name,type:"if",source:"(129:2) {#if $tagsQuery.fetching}",ctx:n}),o}function Nt(n){let t=n[19].name+"",l;const o={c:function(){l=W(t)},l:function(a){l=Z(a,t)},m:function(a,u){w(a,l,u)},p:function(a,u){u&2&&t!==(t=a[19].name+"")&&kt(l,t)},d:function(a){a&&x(l)}};return R("SvelteRegisterBlock",{block:o,id:Nt.name,type:"slot",source:'(137:10) <svelte:fragment slot=\\"summary\\">',ctx:n}),o}function Dt(n){let t,l,o="Tag name",e,a,u=n[19],c,s,r="Tag description",f,d,p,g,h="Human-Readable name and description of the tag that is shown in UI",m,$,k,V="Delete",F,_,M;function K(){n[8].call(a,n[20],n[21])}const G=()=>n[9](a,u),L=()=>n[9](null,u);function i(){return n[10](n[19])}function v(){n[11].call(d,n[20],n[21])}function A(){return n[12](n[19])}function wt(...O){return n[13](n[19],...O)}const tt={c:function(){t=b("div"),l=b("div"),l.textContent=o,e=P(),a=b("input"),c=P(),s=b("div"),s.textContent=r,f=P(),d=b("input"),p=P(),g=b("span"),g.textContent=h,m=P(),$=b("button"),k=b("span"),k.textContent=V,F=P(),this.h()},l:function(T){t=C(T,"DIV",{});var y=q(t);l=C(y,"DIV",{"data-svelte-h":!0}),E(l)!=="svelte-xcwwft"&&(l.textContent=o),e=B(y),a=C(y,"INPUT",{type:!0,class:!0,placeholder:!0}),c=B(y),s=C(y,"DIV",{"data-svelte-h":!0}),E(s)!=="svelte-1256uzk"&&(s.textContent=r),f=B(y),d=C(y,"INPUT",{type:!0,class:!0,placeholder:!0}),y.forEach(x),p=B(T),g=C(T,"SPAN",{slot:!0,"data-svelte-h":!0}),E(g)!=="svelte-2kgxo4"&&(g.textContent=h),m=B(T),$=C(T,"BUTTON",{class:!0});var et=q($);k=C(et,"SPAN",{"data-svelte-h":!0}),E(k)!=="svelte-gz26bx"&&(k.textContent=V),et.forEach(x),F=B(T),this.h()},h:function(){N(l,D,149,14,4184),S(a,"type","text"),S(a,"class","input p-2"),S(a,"placeholder","Name"),N(a,D,150,14,4218),N(s,D,157,14,4473),S(d,"type","text"),S(d,"class","input p-2"),S(d,"placeholder","Description"),N(d,D,158,14,4514),N(t,D,148,12,4164),S(g,"slot","helper"),N(g,D,165,12,4753),N(k,D,168,14,4955),S($,"class","variant-ghost-error btn"),N($,D,167,12,4860)},m:function(T,y){w(T,t,y),I(t,l),I(t,e),I(t,a),J(a,n[19].name),G(),I(t,c),I(t,s),I(t,f),I(t,d),J(d,n[19].description),w(T,p,y),w(T,g,y),w(T,m,y),w(T,$,y),I($,k),w(T,F,y),_||(M=[U(a,"input",K),U(a,"change",i,!1,!1,!1,!1),U(d,"input",v),U(d,"change",A,!1,!1,!1,!1),U($,"click",wt,!1,!1,!1,!1)],_=!0)},p:function(T,y){n=T,y&2&&a.value!==n[19].name&&J(a,n[19].name),u!==n[19]&&(L(),u=n[19],G()),y&2&&d.value!==n[19].description&&J(d,n[19].description)},d:function(T){T&&(x(t),x(p),x(g),x(m),x($),x(F)),L(),_=!1,Ft(M)}};return R("SvelteRegisterBlock",{block:tt,id:Dt.name,type:"slot",source:'(138:10) <svelte:fragment slot=\\"content\\">',ctx:n}),tt}function X(n){let t,l=n[19],o;const e=()=>n[14](t,l),a=()=>n[14](null,l);let u={$$slots:{content:[Dt],summary:[Nt]},$$scope:{ctx:n}};t=new mt({props:u,$$inline:!0}),e();const c={c:function(){vt(t.$$.fragment)},l:function(r){$t(t.$$.fragment,r)},m:function(r,f){xt(t,r,f),o=!0},p:function(r,f){l!==r[19]&&(a(),l=r[19],e());const d={};f&4194314&&(d.$$scope={dirty:f,ctx:r}),t.$set(d)},i:function(r){o||(j(t.$$.fragment,r),o=!0)},o:function(r){Q(t.$$.fragment,r),o=!1},d:function(r){a(),yt(t,r)}};return R("SvelteRegisterBlock",{block:c,id:X.name,type:"each",source:"(135:6) {#each tags as tag}",ctx:n}),c}function St(n){let t,l,o=ot(n[1]),e=[];for(let c=0;c<o.length;c+=1)e[c]=X(gt(n,o,c));const a=c=>Q(e[c],1,1,()=>{e[c]=null}),u={c:function(){for(let s=0;s<e.length;s+=1)e[s].c();t=ct()},l:function(s){for(let r=0;r<e.length;r+=1)e[r].l(s);t=ct()},m:function(s,r){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(s,r);w(s,t,r),l=!0},p:function(s,r){if(r&206){o=ot(s[1]);let f;for(f=0;f<o.length;f+=1){const d=gt(s,o,f);e[f]?(e[f].p(d,r),j(e[f],1)):(e[f]=X(d),e[f].c(),j(e[f],1),e[f].m(t.parentNode,t))}for(ht(),f=o.length;f<e.length;f+=1)a(f);pt()}},i:function(s){if(!l){for(let r=0;r<o.length;r+=1)j(e[r]);l=!0}},o:function(s){e=e.filter(Boolean);for(let r=0;r<e.length;r+=1)Q(e[r]);l=!1},d:function(s){s&&x(t),jt(e,s)}};return R("SvelteRegisterBlock",{block:u,id:St.name,type:"slot",source:"(134:4) <Accordion>",ctx:n}),u}function Y(n){let t,l="Mod Tag Manager",o,e,a,u,c;const s=[Ct,bt,Tt],r=[];function f(p,g){return p[0].fetching?0:p[0].error?1:2}a=f(n),u=r[a]=s[a](n);const d={c:function(){t=b("h1"),t.textContent=l,o=P(),e=b("div"),u.c(),this.h()},l:function(g){t=C(g,"H1",{class:!0,"data-svelte-h":!0}),E(t)!=="svelte-eejrrv"&&(t.textContent=l),o=B(g),e=C(g,"DIV",{class:!0});var h=q(e);u.l(h),h.forEach(x),this.h()},h:function(){S(t,"class","svelte-1egakhm"),N(t,D,135,0,3742),S(e,"class","card"),N(e,D,137,0,3768)},m:function(g,h){w(g,t,h),w(g,o,h),w(g,e,h),r[a].m(e,null),c=!0},p:function(g,[h]){let m=a;a=f(g),a===m?r[a].p(g,h):(ht(),Q(r[m],1,1,()=>{r[m]=null}),pt(),u=r[a],u?u.p(g,h):(u=r[a]=s[a](g),u.c()),j(u,1),u.m(e,null))},i:function(g){c||(j(u),c=!0)},o:function(g){Q(u),c=!1},d:function(g){g&&(x(t),x(o),x(e)),r[a].d()}};return R("SvelteRegisterBlock",{block:d,id:Y.name,type:"component",source:"",ctx:n}),d}const z="New Tag";function qt(n,t,l){let o,{$$slots:e={},$$scope:a}=t;Rt("Page",e,[]);const u=nt();let c=[];const s={},r={};let f=-1;const d=at({query:lt,client:u,variables:{limit:100}});At(d,"tagsQuery"),Et(n,d,i=>l(0,o=i));const p=st();function g(){if(c.find(i=>i.name==z))s[c[c.length-1].id].setOpen(!0),r[c[c.length-1].id].focus();else{const i={id:f--,name:z,description:"Description"};c.push(i),l(1,c),l(0,o),setTimeout(()=>{s[i.id].setOpen(!0);const v=r[i.id];v.focus(),v.getElement().querySelectorAll("input")[0].select()},0)}}async function h(i){if(i.name==z)return;let v=!1;if(i.id<0){try{const A=await u.mutation(rt,{tagName:i.name,description:i.description}).toPromise();A.data&&(i.id=A.data.createTag.id,v=!0)}catch(A){console.log(A)}if(!v){p.trigger({message:`Failed to create Tag '${i.name}'!`,background:"variant-filled-error",timeout:2e3});return}}else{try{v=(await u.mutation(ft,{tagID:i.id,tagName:i.name,description:i.description}).toPromise()).data.updateTag!=null}catch{}if(!v){p.trigger({message:`Failed to update Tag '${i.name}'!`,background:"variant-filled-error",timeout:2e3});return}}p.trigger({message:`Tag '${i.name}' saved!`,background:"variant-filled-success",timeout:2e3})}async function m(i){if(i.name!=z){let v=!1;try{v=(await u.mutation(ut,{tagID:i.id}).toPromise()).data.deleteTag}catch{v=!1}if(!v){p.trigger({message:`Failed to remove Tag '${i.name}'!`,background:"variant-filled-error",timeout:2e3});return}}else c.splice(c.indexOf(i),1);p.trigger({message:`Tag '${i.name}' removed!`,background:"variant-filled-success",timeout:2e3})}function $(i,v){i.stopPropagation(),m(v)}const k=[];Object.keys(t).forEach(i=>{!~k.indexOf(i)&&i.slice(0,2)!=="$$"&&i!=="slot"&&Ut.warn(`<Page> was created with unknown prop '${i}'`)});function V(i,v){i[v].name=this.value,l(1,c),l(0,o)}function F(i,v){it[i?"unshift":"push"](()=>{r[v.id]=i,l(3,r)})}const _=i=>h(i);function M(i,v){i[v].description=this.value,l(1,c),l(0,o)}const K=i=>h(i),G=(i,v)=>$(v,i);function L(i,v){it[i?"unshift":"push"](()=>{s[v.id]=i,l(2,s)})}return n.$capture_state=()=>({getContextClient:nt,queryStore:at,CreateTagDocument:rt,DeleteTagDocument:ut,GetTagsDocument:lt,UpdateTagDocument:ft,Accordion:dt,AccordionItem:mt,getToastStore:st,client:u,tags:c,panels:s,nameFields:r,tagNegativeID:f,defaultNewTagName:z,tagsQuery:d,toastStore:p,newTag:g,tagChange:h,deleteTag:m,onDeleteClick:$,$tagsQuery:o}),n.$inject_state=i=>{"tags"in i&&l(1,c=i.tags),"tagNegativeID"in i&&(f=i.tagNegativeID)},t&&"$$inject"in t&&n.$inject_state(t.$$inject),n.$$.update=()=>{n.$$.dirty&1&&l(1,c=o.data?.getTags||[])},[o,c,s,r,d,g,h,$,V,F,_,M,K,G,L]}class zt extends It{constructor(t){super(t),Pt(this,t,qt,Y,Bt,{}),R("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Y.name})}}export{zt as component};
//# sourceMappingURL=6.CbpGC7df.js.map
